<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="javascript nodejs web developer...">
<meta property="og:type" content="website">
<meta property="og:title" content="WBlog">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="WBlog">
<meta property="og:description" content="javascript nodejs web developer...">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="wangzhiwei">
<meta property="article:tag" content="javascript nodejs web developer fe engineer">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>WBlog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">WBlog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">wangzhiwei blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/28/vue-%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90react-%E9%99%A4%E4%BA%86%E7%94%A8%E5%BE%AE%E5%89%8D%E7%AB%AF%E7%9A%84%E6%96%B9%E5%BC%8F%E8%BF%98%E6%9C%89%E5%88%AB%E7%9A%84%E5%8A%9E%E6%B3%95%E5%90%97%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/28/vue-%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90react-%E9%99%A4%E4%BA%86%E7%94%A8%E5%BE%AE%E5%89%8D%E7%AB%AF%E7%9A%84%E6%96%B9%E5%BC%8F%E8%BF%98%E6%9C%89%E5%88%AB%E7%9A%84%E5%8A%9E%E6%B3%95%E5%90%97%EF%BC%9F/" class="post-title-link" itemprop="url">vue 的项目集成react 除了用微前端的方式还有别的办法吗？</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-28 09:13:54" itemprop="dateCreated datePublished" datetime="2024-12-28T09:13:54+08:00">2024-12-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue-react/" itemprop="url" rel="index"><span itemprop="name">vue + react</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue-react/vue/" itemprop="url" rel="index"><span itemprop="name">vue</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue-react/vue/react/" itemprop="url" rel="index"><span itemprop="name">react</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>将 React 集成到 Vue 项目中除了微前端的方式之外，还有以下几种方法：</p>
<h3 id="直接引入-React-组件："><a href="#直接引入-React-组件：" class="headerlink" title="直接引入 React 组件："></a><strong>直接引入 React 组件</strong>：</h3><ul>
<li>在 Vue 项目中直接引入并渲染 React 组件。这种方法适用于少量的 React 组件集成场景。</li>
<li>使用 <code>react-dom</code> 提供的 <code>render</code> 方法将 React 组件挂载到指定的 DOM 节点中。</li>
</ul>
<h3 id="使用-Web-Components："><a href="#使用-Web-Components：" class="headerlink" title="使用 Web Components："></a><strong>使用 Web Components</strong>：</h3><ul>
<li>将 React 和 Vue 的组件封装为 Web Components（自定义元素）。Web Components 是一种浏览器原生支持的技术，可以在不同的框架之间共享组件。</li>
<li>这种方式的优点是解耦了框架之间的依赖，缺点是可能需要额外的工具或库来支持。</li>
</ul>
<p>使用 Web Components 在 Vue 项目中集成 React</p>
<p>Web Components 是一种浏览器原生支持的技术，允许你创建可复用的自定义元素，并且可以在不同的前端框架（如 Vue 和 React）之间共享这些组件。通过将 React 和 Vue 组件封装为 Web Components，你可以实现两者的无缝集成。</p>
<p>步骤：</p>
<ol>
<li><p><strong>创建 React 组件并封装为 Web Component</strong></p>
<p>首先，你需要创建一个 React 组件，并将其封装为 Web Component。可以使用 <code>react-web-components</code> 或 <code>@webcomponents/webcomponentsjs</code> 等库来简化这个过程。</p>
<p>下面是一个简单的示例，展示如何将 React 组件封装为 Web Component：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/react-components/HelloReact.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineCustomElement &#125; <span class="keyword">from</span> <span class="string">&#x27;react-web-components&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">HelloReact</span> = (<span class="params"></span>) =&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello from React!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 React 组件封装为 Web Component</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HelloReactElement</span> = <span class="title function_">defineCustomElement</span>(<span class="string">&#x27;hello-react&#x27;</span>, <span class="title class_">HelloReact</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HelloReactElement</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>在 Vue 项目中引入并使用 Web Component</strong></p>
<p>接下来，在 Vue 项目中引入并注册这个 Web Component。由于 Web Components 是浏览器原生支持的，因此可以直接在 HTML 中使用它们，或者在 Vue 组件中动态创建。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- public/index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue and React Integration<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入封装好的 Web Component --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/path/to/HelloReactElement.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 Vue 组件中使用 Web Component：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/HelloWorld.vue</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">hello-react</span>&gt;</span><span class="tag">&lt;/<span class="name">hello-react</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a Vue component<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;HelloWorld&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 如果需要在 Vue 组件中与 Web Component 进行交互，可以通过 ref 获取 DOM 元素</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> webComponent = <span class="variable language_">this</span>.<span class="property">$el</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;hello-react&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(webComponent);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>构建和打包</strong></p>
<p>确保你的构建工具（如 Webpack 或 Vite）能够正确处理 Web Components 的打包。对于 React 部分，确保生成的 Web Component 可以被外部项目引用。</p>
</li>
<li><p><strong>注意事项</strong></p>
<ul>
<li><strong>样式隔离</strong>：Web Components 提供了 Shadow DOM 来隔离样式，但并非所有浏览器都完全支持。你可以选择是否启用 Shadow DOM。</li>
<li><strong>事件处理</strong>：Web Components 支持自定义事件，可以通过 <code>addEventListener</code> 和 <code>dispatchEvent</code> 进行通信。</li>
<li><strong>性能</strong>：虽然 Web Components 是浏览器原生支持的，但在某些情况下可能会引入额外的开销，特别是在大量使用时。</li>
</ul>
</li>
</ol>
<p>示例代码总结</p>
<p>通过将 React 组件封装为 Web Components，你可以在 Vue 项目中轻松地引入和使用这些组件。这种方式不仅解耦了两个框架之间的依赖，还提高了组件的复用性和可维护性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React 组件封装为 Web Component</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defineCustomElement &#125; <span class="keyword">from</span> <span class="string">&#x27;react-web-components&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">HelloReact</span> = (<span class="params"></span>) =&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello from React!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HelloReactElement</span> = <span class="title function_">defineCustomElement</span>(<span class="string">&#x27;hello-react&#x27;</span>, <span class="title class_">HelloReact</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HelloReactElement</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vue 组件中使用 Web Component</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">hello-react</span>&gt;</span><span class="tag">&lt;/<span class="name">hello-react</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a Vue component<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;HelloWorld&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> webComponent = <span class="variable language_">this</span>.<span class="property">$el</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;hello-react&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(webComponent);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>这种方法不仅可以用于 Vue 和 React 的集成，还可以扩展到其他前端框架或纯 JavaScript 项目中。</p>
<h3 id="混合开发："><a href="#混合开发：" class="headerlink" title="混合开发："></a><strong>混合开发</strong>：</h3><ul>
<li>在 Vue 项目中创建一个独立的 React 应用，并通过路由或条件渲染的方式在特定页面或模块中加载这个 React 应用。</li>
<li>可以使用 <code>webpack</code> 或其他构建工具配置多个入口文件，分别打包 Vue 和 React 应用。</li>
</ul>
<p>混合开发：Vue 和 React 共存于同一项目中的示例</p>
<p>混合开发是指在一个项目中同时使用 Vue 和 React，通过路由或条件渲染的方式在特定页面或模块中加载不同的框架。这种方式适用于需要逐步迁移现有项目或在某些模块中使用不同框架的场景。</p>
<p>示例场景</p>
<p>假设你有一个基于 Vue 的项目，并且希望在其中集成一个独立的 React 应用，用于处理特定的功能模块（如用户管理、数据分析等）。你可以通过以下步骤实现这一目标：</p>
<p>步骤 1：创建独立的 React 应用</p>
<p>首先，创建一个独立的 React 应用。可以使用 <code>create-react-app</code> 或其他工具来快速搭建。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app react-module</span><br><span class="line"><span class="built_in">cd</span> react-module</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p>这将生成一个打包好的 React 应用，通常位于 <code>build</code> 目录下。</p>
<p>步骤 2：配置 Vue 项目以引入 React 应用</p>
<p>接下来，在 Vue 项目中引入并配置这个 React 应用。可以通过 Webpack 或 Vite 等构建工具来实现多入口配置，确保两个应用可以独立打包和运行。</p>
<p>使用 Webpack 配置多入口</p>
<p>如果你使用的是 Webpack，可以在 <code>webpack.config.js</code> 中配置多个入口文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">app</span>: <span class="string">&#x27;./src/main.js&#x27;</span>, <span class="comment">// Vue 应用的入口</span></span><br><span class="line">    <span class="attr">reactApp</span>: <span class="string">&#x27;./path/to/react-module/build/static/js/main.js&#x27;</span>, <span class="comment">// React 应用的入口</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name].bundle.js&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 Vite 配置多入口</p>
<p>如果你使用的是 Vite，可以在 <code>vite.config.js</code> 中配置多入口：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>()],</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="attr">input</span>: &#123;</span><br><span class="line">        <span class="attr">main</span>: <span class="string">&#x27;src/main.js&#x27;</span>, <span class="comment">// Vue 应用的入口</span></span><br><span class="line">        <span class="attr">reactApp</span>: <span class="string">&#x27;path/to/react-module/build/index.html&#x27;</span>, <span class="comment">// React 应用的入口</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>步骤 3：通过路由或条件渲染加载 React 应用</p>
<p>在 Vue 项目中，可以通过路由或条件渲染的方式加载 React 应用。例如，使用 Vue Router 来定义一个路由规则，当访问特定路径时加载 React 应用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;../views/Home.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/react&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ReactApp&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../views/ReactApp.vue&#x27;</span>), <span class="comment">// 动态导入 React 应用</span></span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  routes,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p>在对应的 Vue 组件中，动态加载 React 应用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/ReactApp.vue</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;react-container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;path/to/react-module/src/App&#x27;</span>; <span class="comment">// 引入 React 应用的根组件</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;ReactApp&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;react-container&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, el);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">ReactDOM</span>.<span class="title function_">unmountComponentAtNode</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;react-container&#x27;</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>步骤 4：确保样式和资源隔离</p>
<p>为了防止 Vue 和 React 应用之间的样式冲突，建议为每个应用使用独立的样式文件或命名空间。例如，可以在 React 应用中使用 CSS Modules 或 styled-components 来隔离样式。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* src/react-module/src/App.module.css */</span></span><br><span class="line"><span class="selector-class">.App</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/react-module/src/App.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">&#x27;./App.module.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;styles.App&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello from React!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<p>步骤 5：测试和调试</p>
<p>最后，确保在开发环境中正确配置热重载和调试工具，以便能够方便地调试 Vue 和 React 应用。可以使用浏览器开发者工具检查 DOM 结构和控制台输出，确保两个应用正常工作。</p>
<p>总结</p>
<p>通过以上步骤，你可以在一个 Vue 项目中集成一个独立的 React 应用。这种方式不仅允许你在现有项目中逐步引入新的技术栈，还可以根据需求灵活选择合适的框架进行开发。以下是完整的代码示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;../views/Home.vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Home</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/react&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ReactApp&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../views/ReactApp.vue&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  routes</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/views/ReactApp.vue</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;react-container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;path/to/react-module/src/App&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&#x27;ReactApp&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;react-container&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, el);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">ReactDOM</span>.<span class="title function_">unmountComponentAtNode</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;react-container&#x27;</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>这种方法不仅可以用于 Vue 和 React 的集成，还可以扩展到其他前端框架或库的混合开发中。</p>
<h3 id="Vue-和-React-共存于同一页面："><a href="#Vue-和-React-共存于同一页面：" class="headerlink" title="Vue 和 React 共存于同一页面："></a><strong>Vue 和 React 共存于同一页面</strong>：</h3><ul>
<li>在同一个页面中同时使用 Vue 和 React 渲染不同的部分。这种方式需要确保两个框架的生命周期和事件处理不会冲突。</li>
<li>可以通过 Vue 的 <code>mounted</code> 钩子函数调用 React 的 <code>ReactDOM.render</code> 方法，在 Vue 管理的 DOM 中嵌入 React 组件。</li>
</ul>
<p>每种方法都有其适用场景和局限性，选择时需根据项目的具体需求和技术栈进行权衡。以下是直接引入 React 组件的一个简单示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 React 和 ReactDOM</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个简单的 React 组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">HelloReact</span> = (<span class="params"></span>) =&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello from React!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 Vue 组件的 mounted 钩子中渲染 React 组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;VueComponent&#x27;</span>,</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 获取要挂载 React 组件的 DOM 节点</span></span><br><span class="line">    <span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">reactContainer</span>.<span class="title function_">appendChild</span>(el)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 渲染 React 组件到该节点</span></span><br><span class="line">    <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">HelloReact</span> /&gt;</span></span>, el)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 组件销毁前卸载 React 组件</span></span><br><span class="line">    <span class="title class_">ReactDOM</span>.<span class="title function_">unmountComponentAtNode</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">reactContainer</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">      &lt;div ref=&quot;reactContainer&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;This is a Vue component&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码展示了如何在一个 Vue 组件中动态地引入并渲染一个 React 组件，同时确保在组件销毁时正确清理 React 组件。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/28/pwa-%E5%A4%8D%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/28/pwa-%E5%A4%8D%E4%B9%A0/" class="post-title-link" itemprop="url">pwa 复习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-28 09:13:46" itemprop="dateCreated datePublished" datetime="2024-12-28T09:13:46+08:00">2024-12-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pwa/" itemprop="url" rel="index"><span itemprop="name">pwa</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="pwa-核心技术"><a href="#pwa-核心技术" class="headerlink" title="pwa 核心技术"></a>pwa 核心技术</h3><p>PWA（Progressive Web App，渐进式Web应用）的核心技术主要包括以下几点：</p>
<ul>
<li><strong>Service Worker</strong>：这是一个可编程的网络代理，允许你拦截和处理应用程序的网络请求，从而实现离线访问、背景同步等功能。</li>
<li><strong>Manifest 文件</strong>：这是一个JSON文件，提供了关于Web应用的基本信息，如名称、图标、主题颜色等，用于将Web应用添加到主屏幕并提供类似原生应用的体验。</li>
<li><strong>promise&#x2F;async&#x2F;await</strong>：确保通信的安全性，PWA要求必须通过HTTPS协议来部署，以保障数据传输的安全。</li>
<li><strong>fetch api</strong>：确保通信的安全性，PWA要求必须通过HTTPS协议来部署，以保障数据传输的安全。</li>
<li><strong>cache storage</strong>：确保通信的安全性，PWA要求必须通过HTTPS协议来部署，以保障数据传输的安全。</li>
<li><strong>常见的缓存策略</strong>：确保通信的安全性，PWA要求必须通过HTTPS协议来部署，以保障数据传输的安全。</li>
<li><strong>notification</strong>：确保通信的安全性，PWA要求必须通过HTTPS协议来部署，以保障数据传输的安全。</li>
</ul>
<p>这些技术共同作用，使得PWA能够提供接近原生应用的用户体验，同时具备跨平台的优势。</p>
<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">app.js</span><br><span class="line"></span><br><span class="line">if (&#x27;serviceWorker&#x27; in navigator) &#123;</span><br><span class="line">    window.addEventListener(&#x27;load&#x27;, () =&gt; &#123;</span><br><span class="line">        navigator.serviceWorker.register(&#x27;/sw.js&#x27;)</span><br><span class="line">            .then(registration =&gt; &#123;</span><br><span class="line">                console.log(&#x27;Service Worker registered with scope:&#x27;, registration.scope);</span><br><span class="line">            &#125;)</span><br><span class="line">            .catch(error =&gt; &#123;</span><br><span class="line">                console.error(&#x27;Service Worker registration failed:&#x27;, error);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">index.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;PWA Demo&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;</span><br><span class="line">    &lt;link rel=&quot;manifest&quot; href=&quot;manifest.json&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;header&gt;</span><br><span class="line">        &lt;h1&gt;PWA Demo&lt;/h1&gt;</span><br><span class="line">    &lt;/header&gt;</span><br><span class="line">    &lt;main style=&quot;background: red;&quot;&gt;</span><br><span class="line">        &lt;p&gt;This is a simple PWA demo.&lt;/p&gt;</span><br><span class="line">    &lt;/main&gt;</span><br><span class="line">    &lt;script src=&quot;app.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">manifest.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;name&quot;: &quot;PWA Demo&quot;,</span><br><span class="line">    &quot;short_name&quot;: &quot;PWA Demo&quot;,</span><br><span class="line">    &quot;start_url&quot;: &quot;/&quot;,</span><br><span class="line">    &quot;display&quot;: &quot;standalone&quot;,</span><br><span class="line">    &quot;background_color&quot;: &quot;#f0f0f0&quot;,</span><br><span class="line">    &quot;theme_color&quot;: &quot;#4CAF50&quot;,</span><br><span class="line">    &quot;icons&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;src&quot;: &quot;icon-192x192.png&quot;,</span><br><span class="line">            &quot;sizes&quot;: &quot;192x192&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;image/png&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;src&quot;: &quot;icon-512x512.png&quot;,</span><br><span class="line">            &quot;sizes&quot;: &quot;512x512&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;image/png&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style.css</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">body &#123;</span><br><span class="line">    font-family: Arial, sans-serif;</span><br><span class="line">    margin: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    height: 100vh;</span><br><span class="line">    background-color: #f0f0f0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">header &#123;</span><br><span class="line">    background-color: #4CAF50;</span><br><span class="line">    color: white;</span><br><span class="line">    width: 100%;</span><br><span class="line">    text-align: center;</span><br><span class="line">    padding: 10px 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main &#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">img &#123;</span><br><span class="line">    margin-top: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sw.js</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const CACHE_NAME = &#x27;pwa-demo-cache-v1&#x27;;</span><br><span class="line">const urlsToCache = [</span><br><span class="line">    &#x27;/&#x27;,</span><br><span class="line">    &#x27;/index.html&#x27;,</span><br><span class="line">    &#x27;/style.css&#x27;,</span><br><span class="line">    &#x27;/app.js&#x27;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">self.addEventListener(&#x27;install&#x27;, async event =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    const cache = await caches.open(CACHE_NAME);</span><br><span class="line">    await cache.addAll(urlsToCache);</span><br><span class="line">    await self.skipWaiting();</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">self.addEventListener(&#x27;activate&#x27;, async event =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    const keys = await caches.keys();</span><br><span class="line"></span><br><span class="line">    keys.forEach(key =&gt; &#123;</span><br><span class="line">        if (key !== CACHE_NAME) &#123;</span><br><span class="line">            caches.delete(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    await self.clients.claim();</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">self.addEventListener(&#x27;fetch&#x27;, event =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    // 1. 只缓存同源的内容</span><br><span class="line">    const req = event.request;</span><br><span class="line">    const url = new URL(req.url);</span><br><span class="line">    if (url.origin !== location.origin) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 2. 接口走网络优先策略 静态资源走缓存优先策略</span><br><span class="line">    if (req.url.includes(&#x27;/api/&#x27;)) &#123;</span><br><span class="line">        event.respondWith(</span><br><span class="line">            networkFirst(event.request)</span><br><span class="line">        );</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        event.respondWith(</span><br><span class="line">            cacheFirst(event.request)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// networkFirst 一般适用于动态资源</span><br><span class="line">async function networkFirst(request) &#123;</span><br><span class="line"></span><br><span class="line">    const cache = await caches.open(CACHE_NAME);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        const response = await fetch(request);</span><br><span class="line">        //保证缓存最新的数据</span><br><span class="line">        cache.put(request, response.clone());</span><br><span class="line">        return response;</span><br><span class="line">    &#125; catch (error) &#123;    </span><br><span class="line">        const cachedResponse = await cache.match(request);</span><br><span class="line">        return cachedResponse;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// catchFirst 一般适用于静态资源</span><br><span class="line">async function cacheFirst(request) &#123;</span><br><span class="line">    const cache = await caches.open(CACHE_NAME);</span><br><span class="line">    const cachedResponse = await cache.match(request);</span><br><span class="line">    if (cachedResponse) &#123;</span><br><span class="line">        return cachedResponse;</span><br><span class="line">    &#125;</span><br><span class="line">    const response = await fetch(request);</span><br><span class="line">    cache.put(request, response.clone());</span><br><span class="line">    return response;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、https 子签名证书可能会导致 pwa register 失败</span><br><span class="line">2、接口跨域名</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/pwa.png"></p>
<p><img src="/../images/pwa_1.png"></p>
<p><img src="/../images/pwa_2.png"></p>
<p><img src="/../images/pwa_3.png"></p>
<p><img src="/../images/pwa_4.png"></p>
<p><img src="/../images/pwa_5.png"></p>
<p><img src="/../images/pwa_6.png"></p>
<p>vite项目改造</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import &#123; VitePWA &#125; from &#x27;vite-plugin-pwa&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vitePlugins.push(</span><br><span class="line">    VitePWA(&#123;</span><br><span class="line">        registerType: &#x27;autoUpdate&#x27;,</span><br><span class="line">        includeAssets: [&#x27;favicon.ico&#x27;],</span><br><span class="line">        manifest: &#123;</span><br><span class="line">            name: &#x27;xxx&#x27;,</span><br><span class="line">            short_name:&#x27;xxx&#x27;,</span><br><span class="line">            description: &#x27;xxx&#x27;,</span><br><span class="line">            theme_color: &#x27;#ffffff&#x27;,</span><br><span class="line">            start_url: &#x27;/demo/&#x27;,</span><br><span class="line">            display: &#x27;standalone&#x27;,</span><br><span class="line">            form_factor: &#x27;wide&#x27;,</span><br><span class="line">            </span><br><span class="line">            icons: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;src&quot;: &quot;./images/icon-192x192.png&quot;,</span><br><span class="line">                    &quot;sizes&quot;: &quot;192x192&quot;,</span><br><span class="line">                    &quot;type&quot;: &quot;image/png&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;src&quot;: &quot;/images/icon-512x512.png&quot;,</span><br><span class="line">                    &quot;sizes&quot;: &quot;512x512&quot;,</span><br><span class="line">                    &quot;type&quot;: &quot;image/png&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        workbox: &#123;</span><br><span class="line">            maximumFileSizeToCacheInBytes: 10 * 1024 * 1024, // 10M</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>参考地址：<br>MDN地址：<br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps">https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/27/react%E5%A4%8D%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/27/react%E5%A4%8D%E4%B9%A0/" class="post-title-link" itemprop="url">react复习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-27 14:17:09" itemprop="dateCreated datePublished" datetime="2024-12-27T14:17:09+08:00">2024-12-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react/" itemprop="url" rel="index"><span itemprop="name">react</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react/javascript/" itemprop="url" rel="index"><span itemprop="name">javascript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="react-复习-（v16-8-0）-目前版本为-19-0-0，-demo是在-19-0-0环境下运行"><a href="#react-复习-（v16-8-0）-目前版本为-19-0-0，-demo是在-19-0-0环境下运行" class="headerlink" title="react 复习 （v16.8.0） 目前版本为 19.0.0， demo是在 19.0.0环境下运行"></a>react 复习 （v16.8.0） 目前版本为 19.0.0， demo是在 19.0.0环境下运行</h3><h3 id="什么是无状态组件，什么是有状态组件？"><a href="#什么是无状态组件，什么是有状态组件？" class="headerlink" title="什么是无状态组件，什么是有状态组件？"></a>什么是无状态组件，什么是有状态组件？</h3><p>在React中，组件可以根据其是否包含状态（state）分为无状态组件和有状态组件。</p>
<ul>
<li><p><strong>无状态组件（Stateless Component）</strong>：</p>
<ul>
<li>也称为纯函数组件（Functional Component），因为它通常是一个简单的JavaScript函数。</li>
<li>不包含内部状态（state），也不使用生命周期方法。</li>
<li>只根据传入的属性（props）来渲染UI，不会因为自身的状态变化而重新渲染。</li>
<li>示例代码：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Welcome</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>有状态组件（Stateful Component）</strong>：</p>
<ul>
<li>通常是指类组件（Class Component），虽然函数组件也可以通过使用<code>useState</code>等Hooks拥有状态。</li>
<li>包含内部状态（state），可以管理并响应数据的变化。</li>
<li>可以定义和使用生命周期方法，如<code>componentDidMount</code>、<code>componentDidUpdate</code>等。</li>
<li>示例代码：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Welcome</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">name</span>: <span class="string">&#x27;World&#x27;</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 组件挂载后的操作</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.state.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>随着React Hooks的引入，函数组件也可以拥有状态和其他特性，因此这种区分逐渐变得不那么严格。</p>
<h3 id="pureComponent-和-memo-能够对比传入属性是否有变化，如果变化了，就重新渲染，否则不渲染。"><a href="#pureComponent-和-memo-能够对比传入属性是否有变化，如果变化了，就重新渲染，否则不渲染。" class="headerlink" title="pureComponent  和 memo 能够对比传入属性是否有变化，如果变化了，就重新渲染，否则不渲染。"></a>pureComponent  和 memo 能够对比传入属性是否有变化，如果变化了，就重新渲染，否则不渲染。</h3><p>是否有变化是如何判定的？ undefined 算不算相等</p>
<p>在React中，<code>PureComponent</code> 和 <code>memo</code> 都用于优化组件的渲染性能，通过浅比较（shallow comparison）传入的属性（props）或状态（state），以决定是否需要重新渲染。</p>
<ul>
<li><p>浅比较的判定方式</p>
</li>
<li><p><strong>浅比较</strong>：只比较对象的第一层属性，不会递归地深入比较嵌套的对象或数组。</p>
</li>
<li><p><strong>基本类型</strong>（如数字、字符串、布尔值、<code>null</code>、<code>undefined</code>）：</p>
<ul>
<li>直接使用严格相等运算符（<code>===</code>）进行比较。</li>
<li>对于<code>undefined</code>，如果两个值都是<code>undefined</code>，则认为它们是相等的。</li>
</ul>
</li>
<li><p><code>PureComponent</code> 和 <code>memo</code> 的具体行为</p>
</li>
</ul>
<ol>
<li><p>**<code>PureComponent</code>**：</p>
<ul>
<li>只适用于类组件。</li>
<li>自动对<code>this.props</code>和<code>this.state</code>进行浅比较。</li>
<li>如果浅比较结果显示没有变化，则跳过组件的重新渲染。</li>
</ul>
</li>
<li><p>**<code>memo</code>**：</p>
<ul>
<li>适用于函数组件。</li>
<li>默认情况下，对组件的<code>props</code>进行浅比较。</li>
<li>如果浅比较结果显示没有变化，则跳过组件的重新渲染。</li>
<li>可以通过传递自定义的比较函数来控制比较逻辑。</li>
</ul>
</li>
</ol>
<ul>
<li>示例代码</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PureComponent 示例</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyPureComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// memo 示例</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyMemoComponent</span> = <span class="title class_">React</span>.<span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>undefined</code> 的处理</li>
</ul>
<p>对于<code>undefined</code>，浅比较会使用严格相等运算符（<code>===</code>）进行比较。因此，如果两个值都是<code>undefined</code>，它们会被认为是相等的。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a === b); <span class="comment">// 输出: true</span></span><br></pre></td></tr></table></figure>

<p>因此，在<code>PureComponent</code>和<code>memo</code>的浅比较中，两个<code>undefined</code>值会被认为是相等的，不会触发重新渲染。</p>
<ul>
<li><p>总结</p>
</li>
<li><p><code>PureComponent</code> 和 <code>memo</code> 使用浅比较来判断属性是否有变化。</p>
</li>
<li><p>浅比较使用严格相等运算符（<code>===</code>）进行比较。</p>
</li>
<li><p>对于<code>undefined</code>，如果两个值都是<code>undefined</code>，则认为它们是相等的，不会触发重新渲染。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import React, &#123; Component, PureComponent, memo &#125; from &#x27;react&#x27;;</span><br><span class="line">import logo from &#x27;./logo.svg&#x27;;</span><br><span class="line">import &#x27;./App.css&#x27;;</span><br><span class="line"></span><br><span class="line">// 避免组建重新渲染 shouldComponentUpdate pureComponent memo 组件拆分的越简单 使用 pureComponent memo 的机会也就越多</span><br><span class="line"></span><br><span class="line">// class Foo extends Component &#123;</span><br><span class="line"></span><br><span class="line">//   shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line"></span><br><span class="line">//     if (this.props.name === nextProps.name) &#123;</span><br><span class="line">//       return false;</span><br><span class="line">//     &#125;</span><br><span class="line">//     return true;</span><br><span class="line">//   &#125;</span><br><span class="line">//   render() &#123;</span><br><span class="line">//     console.log(&#x27;Foo&#x27;);</span><br><span class="line">//     return null;</span><br><span class="line">//   &#125;</span><br><span class="line">// &#125;</span><br><span class="line"></span><br><span class="line">// 只有传入的props的第一级发生变化时，才更新</span><br><span class="line">// class Foo extends PureComponent &#123;</span><br><span class="line">//   render() &#123;</span><br><span class="line">//     console.log(&#x27;Foo&#x27;);</span><br><span class="line">//     return &lt;div&gt;&#123;this.props.person.age&#125;&lt;/div&gt;;</span><br><span class="line">//   &#125;</span><br><span class="line">// &#125;</span><br><span class="line"></span><br><span class="line">//无状态组件 不可以使用 this</span><br><span class="line">// function Foo(props) &#123;</span><br><span class="line">//   console.log(&#x27;Foo&#x27;);</span><br><span class="line">//   // return &lt;div&gt;&#123;this.props.person.age&#125;&lt;/div&gt;;</span><br><span class="line">//   return &lt;div&gt;&#123;props.person.age&#125;&lt;/div&gt;;</span><br><span class="line">// &#125;</span><br><span class="line"></span><br><span class="line">const Foo = memo(function Foo(props) &#123;</span><br><span class="line">  console.log(&#x27;Foo&#x27;);</span><br><span class="line">  return &lt;div&gt;&#123;props.person.age&#125;&lt;/div&gt;;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    count: 0,</span><br><span class="line">    person: &#123;</span><br><span class="line">      age: 1,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 类属性</span><br><span class="line">  callback = () =&gt; &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line"></span><br><span class="line">    const person = this.state.person;</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; &#123;</span><br><span class="line">          person.age++;</span><br><span class="line">          this.setState(&#123; count: this.state.count + 1 &#125;);</span><br><span class="line">        &#125;&#125;&gt;Add&lt;/button&gt;</span><br><span class="line">        &#123;/* &lt;button onClick=&#123;() =&gt; this.setState(&#123; count: this.state.count + 1 &#125;)&#125;&gt;Add&lt;/button&gt; */&#125;</span><br><span class="line"></span><br><span class="line">        &#123;/* person 本身没变化，但是cb每次都传入新的引用，导致Foo组件重新渲染 */&#125;</span><br><span class="line">        &#123;/* &lt;Foo person=&#123;person&#125; cb=&#123;() =&gt; &#123; &#125;&#125; /&gt; */&#125;</span><br><span class="line"></span><br><span class="line">        &lt;Foo person=&#123;person&#125; cb=&#123;this.callback&#125; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="React-Hooks-提供了多种工具来简化函数组件的开发，使你可以更轻松地管理状态、副作用和其他特性。常用-Hooks-包括："><a href="#React-Hooks-提供了多种工具来简化函数组件的开发，使你可以更轻松地管理状态、副作用和其他特性。常用-Hooks-包括：" class="headerlink" title="React Hooks 提供了多种工具来简化函数组件的开发，使你可以更轻松地管理状态、副作用和其他特性。常用 Hooks 包括："></a>React Hooks 提供了多种工具来简化函数组件的开发，使你可以更轻松地管理状态、副作用和其他特性。常用 Hooks 包括：</h3><p>useState：管理状态。<br>useEffect：处理副作用。<br>useContext：访问上下文。<br>useCallback：缓存函数。<br>useMemo：缓存计算结果。<br>useRef：创建可变引用。</p>
<p>useReducer：处理复杂状态逻辑。<br>useImperativeHandle：自定义暴露给父组件的实例值。<br>useLayoutEffect：同步执行的副作用。<br>useDebugValue：调试自定义 Hook。</p>
<h3 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h3><p>作用：用于缓存函数，避免不必要的重新创建。<br>使用场景：当传递给子组件的函数在父组件每次渲染时都重新创建时，会导致子组件不必要的重新渲染。useCallback可以缓存这个函数，只有在依赖项发生变化时才重新创建。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const memoizedCallback = useCallback(() =&gt; &#123;</span><br><span class="line">  doSomething(a, b);</span><br><span class="line">&#125;, [a, b]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><p>作用：用于缓存计算结果，避免不必要的重复计算。<br>使用场景：当某个复杂的计算结果只依赖于某些特定的值时，可以使用useMemo来缓存这个结果，只有在依赖项发生变化时才重新计算。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const memoizedValue = useMemo(() =&gt; computeExpensiveValue(a, b), [a, b]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h3><p>作用：用于订阅React的Context对象，以便在组件中访问上下文中的值。<br>使用场景：当需要在多个层级嵌套的组件之间共享状态或数据时，可以使用Context API，而useContext则提供了更简洁的方式来消费这些数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const value = useContext(MyContext);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><p>作用：用于创建一个可变的引用对象，其值在组件的整个生命周期内保持不变。<br>使用场景：<br>访问DOM元素。<br>存储不触发重新渲染的数据（如计数器、定时器ID等）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const inputEl = useRef(null);</span><br><span class="line"></span><br><span class="line">useEffect(() =&gt; &#123;</span><br><span class="line">  // 可以直接访问inputEl.current</span><br><span class="line">  inputEl.current.focus();</span><br><span class="line">&#125;, []);</span><br><span class="line"></span><br><span class="line">return &lt;input ref=&#123;inputEl&#125; /&gt;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>总结：<br>useCallback useMemo useRef useContext这些是React中常用的Hooks，用于优化性能、管理状态和共享上下文。下面分别介绍它们的作用和用法：</p>
<h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h3><p>useEffect 是 React 中用于处理副作用的 Hook。副作用包括数据获取、订阅、手动修改 DOM、记录日志等操作。useEffect 允许你在函数组件中执行这些操作，类似于类组件中的生命周期方法（如 componentDidMount、componentDidUpdate 和 componentWillUnmount）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component, memo, useState, useCallback, useMemo, useRef, useContext, useEffect &#125; from &#x27;react&#x27;;</span><br><span class="line">import logo from &#x27;./logo.svg&#x27;;</span><br><span class="line">import &#x27;./App.css&#x27;;</span><br><span class="line"></span><br><span class="line">const MyContext = React.createContext();</span><br><span class="line"></span><br><span class="line">const Foo = memo(function Foo(props) &#123;</span><br><span class="line">  console.log(&#x27;Foo&#x27;);</span><br><span class="line">  return &lt;div&gt;&#123;props.person.age&#125; &#123;props.count&#125;&lt;/div&gt;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function FunctionalApp() &#123;</span><br><span class="line">  const [count, setCount] = useState(0);</span><br><span class="line">  const [person, setPerson] = useState(&#123; age: 1 &#125;);</span><br><span class="line"></span><br><span class="line">  const callback = useCallback(() =&gt; &#123;&#125;, []);</span><br><span class="line"></span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    console.log(`Count has changed to $&#123;count&#125;`);</span><br><span class="line">    const timer = setInterval(() =&gt; &#123;</span><br><span class="line">      setCount(prevCount =&gt; prevCount + 1);</span><br><span class="line">    &#125;, 5000);</span><br><span class="line"></span><br><span class="line">    return () =&gt; &#123;</span><br><span class="line">      console.log(&#x27;Clearing interval&#x27;);</span><br><span class="line">      clearInterval(timer);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;MyContext.Provider value=&#123;&#123; count, person, callback &#125;&#125;&gt;</span><br><span class="line">      &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; &#123;</span><br><span class="line">          setPerson(prevPerson =&gt; (&#123; ...prevPerson, age: prevPerson.age + 1 &#125;));</span><br><span class="line">          setCount(prevCount =&gt; prevCount + 1);</span><br><span class="line">        &#125;&#125;&gt;Add&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Foo person=&#123;person&#125; count=&#123;count&#125; cb=&#123;callback&#125; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/MyContext.Provider&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default FunctionalApp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h3><p>useReducer 是 React 提供的一个 Hook，用于管理复杂的状态逻辑。它特别适用于状态逻辑涉及多个子状态或需要处理复杂的更新逻辑的情况。useReducer 的工作原理类似于 Redux 中的 reducer 函数，通过一个 reducer 函数来处理不同的动作（actions），从而更新状态。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">const [state, dispatch] = useReducer(reducer, initialState);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import React, &#123; useReducer &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// 定义初始状态</span><br><span class="line">const initialState = &#123; count: 0 &#125;;</span><br><span class="line"></span><br><span class="line">// 定义 reducer 函数</span><br><span class="line">function reducer(state, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &#x27;increment&#x27;:</span><br><span class="line">      return &#123; count: state.count + 1 &#125;;</span><br><span class="line">    case &#x27;decrement&#x27;:</span><br><span class="line">      return &#123; count: state.count - 1 &#125;;</span><br><span class="line">    case &#x27;reset&#x27;:</span><br><span class="line">      return initialState;</span><br><span class="line">    default:</span><br><span class="line">      throw new Error();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Counter() &#123;</span><br><span class="line">  // 使用 useReducer 钩子</span><br><span class="line">  const [state, dispatch] = useReducer(reducer, initialState);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;Count: &#123;state.count&#125;&lt;/p&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &#x27;increment&#x27; &#125;)&#125;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &#x27;decrement&#x27; &#125;)&#125;&gt;-&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &#x27;reset&#x27; &#125;)&#125;&gt;Reset&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Counter;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>复杂状态管理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import React, &#123; useReducer &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// 定义初始状态</span><br><span class="line">const initialState = &#123;</span><br><span class="line">  count: 0,</span><br><span class="line">  step: 1</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 定义 reducer 函数</span><br><span class="line">function reducer(state, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &#x27;increment&#x27;:</span><br><span class="line">      return &#123; ...state, count: state.count + state.step &#125;;</span><br><span class="line">    case &#x27;decrement&#x27;:</span><br><span class="line">      return &#123; ...state, count: state.count - state.step &#125;;</span><br><span class="line">    case &#x27;reset&#x27;:</span><br><span class="line">      return initialState;</span><br><span class="line">    case &#x27;setStep&#x27;:</span><br><span class="line">      return &#123; ...state, step: action.payload &#125;;</span><br><span class="line">    default:</span><br><span class="line">      throw new Error();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Counter() &#123;</span><br><span class="line">  // 使用 useReducer 钩子</span><br><span class="line">  const [state, dispatch] = useReducer(reducer, initialState);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;Count: &#123;state.count&#125;&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;Step: &#123;state.step&#125;&lt;/p&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &#x27;increment&#x27; &#125;)&#125;&gt;+&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &#x27;decrement&#x27; &#125;)&#125;&gt;-&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: &#x27;reset&#x27; &#125;)&#125;&gt;Reset&lt;/button&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type=&quot;number&quot;</span><br><span class="line">        value=&#123;state.step&#125;</span><br><span class="line">        onChange=&#123;(e) =&gt; dispatch(&#123; type: &#x27;setStep&#x27;, payload: Number(e.target.value) &#125;)&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Counter;</span><br></pre></td></tr></table></figure>

<h3 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h3><p>useImperativeHandle 是 React 提供的一个 Hook，用于自定义暴露给父组件的实例值。它允许你在使用 ref 时，控制父组件可以访问的子组件的方法或属性。这对于封装子组件的内部实现细节，只暴露必要的接口非常有用。</p>
<p>useImperativeHandle 接收三个参数：</p>
<p>ref：从父组件传递下来的 ref。<br>createHandle：一个函数，返回一个对象，该对象包含父组件可以访问的方法或属性。<br>dependencies：依赖项数组，当依赖项变化时，createHandle 会被重新执行。</p>
<p>下面是一个简单的示例，展示了如何使用 useImperativeHandle 来控制父组件可以访问的子组件的方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">子组件 FancyInput：</span><br><span class="line"></span><br><span class="line">    使用 forwardRef 将 ref 传递给子组件。</span><br><span class="line">    使用 useState 管理输入框的值。</span><br><span class="line">    使用 useImperativeHandle 自定义暴露给父组件的方法：</span><br><span class="line">    focus：使输入框获得焦点。</span><br><span class="line">    getValue：获取输入框的当前值。</span><br><span class="line"></span><br><span class="line">父组件 ParentComponent：</span><br><span class="line"></span><br><span class="line">    使用 useRef 创建一个 ref 对象。</span><br><span class="line">    定义 focusInput 方法，通过 ref 调用子组件的 focus 方法。</span><br><span class="line">    定义 getValue 方法，通过 ref 调用子组件的 getValue 方法。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import React, &#123; useRef, useImperativeHandle, forwardRef, useState &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// 子组件</span><br><span class="line">const FancyInput = forwardRef((props, ref) =&gt; &#123;</span><br><span class="line">  const [value, setValue] = useState(&#x27;&#x27;);</span><br><span class="line"></span><br><span class="line">  // 自定义暴露给父组件的方法</span><br><span class="line">  useImperativeHandle(ref, () =&gt; (&#123;</span><br><span class="line">    focus: () =&gt; &#123;</span><br><span class="line">      inputRef.current.focus();</span><br><span class="line">    &#125;,</span><br><span class="line">    getValue: () =&gt; &#123;</span><br><span class="line">      return value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;));</span><br><span class="line"></span><br><span class="line">  const inputRef = useRef(null);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;input</span><br><span class="line">      ref=&#123;inputRef&#125;</span><br><span class="line">      value=&#123;value&#125;</span><br><span class="line">      onChange=&#123;(e) =&gt; setValue(e.target.value)&#125;</span><br><span class="line">      placeholder=&quot;Type something...&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 父组件</span><br><span class="line">function ParentComponent() &#123;</span><br><span class="line">  const inputRef = useRef(null);</span><br><span class="line"></span><br><span class="line">  const focusInput = () =&gt; &#123;</span><br><span class="line">    inputRef.current.focus();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const getValue = () =&gt; &#123;</span><br><span class="line">    const inputValue = inputRef.current.getValue();</span><br><span class="line">    alert(`Input value: $&#123;inputValue&#125;`);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;FancyInput ref=&#123;inputRef&#125; /&gt;</span><br><span class="line">      &lt;button onClick=&#123;focusInput&#125;&gt;Focus Input&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;getValue&#125;&gt;Get Value&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default ParentComponent;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>复杂示例：控制子组件的内部状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useRef, useImperativeHandle, forwardRef, useState &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// 子组件</span><br><span class="line">const Timer = forwardRef((props, ref) =&gt; &#123;</span><br><span class="line">  const [seconds, setSeconds] = useState(0);</span><br><span class="line">  const timerRef = useRef(null);</span><br><span class="line"></span><br><span class="line">  useImperativeHandle(ref, () =&gt; (&#123;</span><br><span class="line">    start: () =&gt; &#123;</span><br><span class="line">      timerRef.current = setInterval(() =&gt; &#123;</span><br><span class="line">        setSeconds(prevSeconds =&gt; prevSeconds + 1);</span><br><span class="line">      &#125;, 1000);</span><br><span class="line">    &#125;,</span><br><span class="line">    stop: () =&gt; &#123;</span><br><span class="line">      clearInterval(timerRef.current);</span><br><span class="line">    &#125;,</span><br><span class="line">    reset: () =&gt; &#123;</span><br><span class="line">      clearInterval(timerRef.current);</span><br><span class="line">      setSeconds(0);</span><br><span class="line">    &#125;,</span><br><span class="line">    getSeconds: () =&gt; &#123;</span><br><span class="line">      return seconds;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;));</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;Seconds: &#123;seconds&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 父组件</span><br><span class="line">function ParentComponent() &#123;</span><br><span class="line">  const timerRef = useRef(null);</span><br><span class="line"></span><br><span class="line">  const startTimer = () =&gt; &#123;</span><br><span class="line">    timerRef.current.start();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const stopTimer = () =&gt; &#123;</span><br><span class="line">    timerRef.current.stop();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const resetTimer = () =&gt; &#123;</span><br><span class="line">    timerRef.current.reset();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const getSeconds = () =&gt; &#123;</span><br><span class="line">    const currentSeconds = timerRef.current.getSeconds();</span><br><span class="line">    alert(`Current Seconds: $&#123;currentSeconds&#125;`);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Timer ref=&#123;timerRef&#125; /&gt;</span><br><span class="line">      &lt;button onClick=&#123;startTimer&#125;&gt;Start&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;stopTimer&#125;&gt;Stop&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;resetTimer&#125;&gt;Reset&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;getSeconds&#125;&gt;Get Seconds&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default ParentComponent;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="useImperativeHandle-对应-vue3中的实现-ref-和-defineExpose"><a href="#useImperativeHandle-对应-vue3中的实现-ref-和-defineExpose" class="headerlink" title="useImperativeHandle  对应 vue3中的实现  ref 和 defineExpose"></a>useImperativeHandle  对应 vue3中的实现  ref 和 defineExpose</h3><p>ref：用于在父组件中引用子组件或 DOM 元素。<br>defineExpose：用于显式地暴露子组件的属性和方法给父组件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">子组件 FancyInput.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input</span><br><span class="line">    ref=&quot;inputRef&quot;</span><br><span class="line">    v-model=&quot;value&quot;</span><br><span class="line">    placeholder=&quot;Type something...&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, defineExpose &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const inputRef = ref(null);</span><br><span class="line">    const value = ref(&#x27;&#x27;);</span><br><span class="line"></span><br><span class="line">    // 自定义暴露给父组件的方法</span><br><span class="line">    const focus = () =&gt; &#123;</span><br><span class="line">      inputRef.value.focus();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    const getValue = () =&gt; &#123;</span><br><span class="line">      return value.value;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // 显式暴露方法给父组件</span><br><span class="line">    defineExpose(&#123;</span><br><span class="line">      focus,</span><br><span class="line">      getValue</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      inputRef,</span><br><span class="line">      value</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">父组件 ParentComponent.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;FancyInput ref=&quot;fancyInputRef&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;focusInput&quot;&gt;Focus Input&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;getValue&quot;&gt;Get Value&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import FancyInput from &#x27;./FancyInput.vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    FancyInput</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const fancyInputRef = ref(null);</span><br><span class="line"></span><br><span class="line">    const focusInput = () =&gt; &#123;</span><br><span class="line">      fancyInputRef.value.focus();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    const getValue = () =&gt; &#123;</span><br><span class="line">      const inputValue = fancyInputRef.value.getValue();</span><br><span class="line">      alert(`Input value: $&#123;inputValue&#125;`);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      fancyInputRef,</span><br><span class="line">      focusInput,</span><br><span class="line">      getValue</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="useLayoutEffect-同步执行的副作用。"><a href="#useLayoutEffect-同步执行的副作用。" class="headerlink" title="useLayoutEffect 同步执行的副作用。"></a>useLayoutEffect 同步执行的副作用。</h3><p>与 useEffect 类似，但 useLayoutEffect 会在浏览器绘制之前执行，避免闪烁问题。<br>由于 useLayoutEffect 会阻塞浏览器绘制，应谨慎使用，避免性能问题。</p>
<p>useLayoutEffect 是 React 提供的一个 Hook，用于在浏览器绘制之前同步执行副作用。它与 useEffect 类似，但有一些关键的区别，特别是在性能和执行时机方面。以下是 useLayoutEffect 的详细解释和使用场景。</p>
<p>示例：使用 useLayoutEffect 读取 DOM 布局</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useLayoutEffect, useRef, useState &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function LayoutEffectExample() &#123;</span><br><span class="line">  const divRef = useRef(null);</span><br><span class="line">  const [height, setHeight] = useState(0);</span><br><span class="line"></span><br><span class="line">  useLayoutEffect(() =&gt; &#123;</span><br><span class="line">    if (divRef.current) &#123;</span><br><span class="line">      setHeight(divRef.current.offsetHeight);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div ref=&#123;divRef&#125; style=&#123;&#123; height: &#x27;100px&#x27;, backgroundColor: &#x27;lightblue&#x27; &#125;&#125;&gt;</span><br><span class="line">        This div has a height of &#123;height&#125;px</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default LayoutEffectExample;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="useDebugValue：调试自定义-Hook。"><a href="#useDebugValue：调试自定义-Hook。" class="headerlink" title="useDebugValue：调试自定义 Hook。"></a>useDebugValue：调试自定义 Hook。</h3><p>useDebugValue 是 React 提供的一个 Hook，用于在 React DevTools 中显示自定义 Hook 的标签。这有助于调试自定义 Hook，使其在 DevTools 中更易于识别和理解。以下是 useDebugValue 的详细解释和使用场景。</p>
<p>示例：格式化显示值<br>有时，你可能希望在 DevTools 中显示更复杂的值或格式化后的值。可以传递一个格式化函数来实现这一点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useState, useDebugValue &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function useCustomHook(initialValue) &#123;</span><br><span class="line">  const [value, setValue] = useState(initialValue);</span><br><span class="line"></span><br><span class="line">  // 使用 useDebugValue 显示格式化后的值</span><br><span class="line">  useDebugValue(value, value =&gt; `Count: $&#123;value&#125;`);</span><br><span class="line"></span><br><span class="line">  return [value, setValue];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  const [count, setCount] = useCustomHook(0);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;Count: &#123;count&#125;&lt;/p&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;Increment&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>


<h3 id="React-lazy-和-Suspense"><a href="#React-lazy-和-Suspense" class="headerlink" title="React.lazy 和 Suspense"></a>React.lazy 和 Suspense</h3><p>在 React 中，React.lazy 和 Suspense 是用于代码分割和懒加载的工具。它们可以帮助你按需加载组件，从而提高应用的性能和加载速度。以下是 React.lazy 和 Suspense 的详细解释和使用场景。</p>
<p>在实际应用中，React.lazy 和 Suspense 通常与路由结合使用，实现路由懒加载。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">// Home.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">const Home = () =&gt; &#123;</span><br><span class="line">  return &lt;div&gt;This is the Home Component&lt;/div&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default Home;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// About.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">const About = () =&gt; &#123;</span><br><span class="line">  return &lt;div&gt;This is the About Component&lt;/div&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default About;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// App.js</span><br><span class="line">import React, &#123; Suspense, lazy &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; BrowserRouter as Router, Route, Switch, Link &#125; from &#x27;react-router-dom&#x27;;</span><br><span class="line"></span><br><span class="line">const Home = lazy(() =&gt; import(&#x27;./Home&#x27;));</span><br><span class="line">const About = lazy(() =&gt; import(&#x27;./About&#x27;));</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;Router&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;nav&gt;</span><br><span class="line">          &lt;ul&gt;</span><br><span class="line">            &lt;li&gt;</span><br><span class="line">              &lt;Link to=&quot;/&quot;&gt;Home&lt;/Link&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">            &lt;li&gt;</span><br><span class="line">              &lt;Link to=&quot;/about&quot;&gt;About&lt;/Link&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">          &lt;/ul&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line">        &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;/div&gt;&#125;&gt;</span><br><span class="line">          &lt;Switch&gt;</span><br><span class="line">            &lt;Route exact path=&quot;/&quot; component=&#123;Home&#125; /&gt;</span><br><span class="line">            &lt;Route path=&quot;/about&quot; component=&#123;About&#125; /&gt;</span><br><span class="line">          &lt;/Switch&gt;</span><br><span class="line">        &lt;/Suspense&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="React-中的高阶组件"><a href="#React-中的高阶组件" class="headerlink" title="React 中的高阶组件"></a>React 中的高阶组件</h3><p>当然！高阶组件（Higher-Order Component, HOC）是 React 中用于复用组件逻辑的一种高级技术。withAuth 是一个常见的 HOC 示例，用于检查用户是否已认证，并根据认证状态决定渲染哪个组件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">src/hocs/withAuth.js</span><br><span class="line"></span><br><span class="line">import React, &#123; useEffect, useState &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; Redirect &#125; from &#x27;react-router-dom&#x27;;</span><br><span class="line"></span><br><span class="line">const withAuth = (WrappedComponent) =&gt; &#123;</span><br><span class="line">  const AuthenticatedComponent = (props) =&gt; &#123;</span><br><span class="line">    const [isAuthenticated, setIsAuthenticated] = useState(null);</span><br><span class="line"></span><br><span class="line">    useEffect(() =&gt; &#123;</span><br><span class="line">      // 模拟异步认证检查</span><br><span class="line">      const checkAuth = async () =&gt; &#123;</span><br><span class="line">        // 这里可以替换为实际的认证检查逻辑</span><br><span class="line">        const isAuthenticated = localStorage.getItem(&#x27;authToken&#x27;);</span><br><span class="line">        setIsAuthenticated(isAuthenticated);</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      checkAuth();</span><br><span class="line">    &#125;, []);</span><br><span class="line"></span><br><span class="line">    if (isAuthenticated === null) &#123;</span><br><span class="line">      return &lt;div&gt;Loading...&lt;/div&gt;; // 加载状态</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (!isAuthenticated) &#123;</span><br><span class="line">      return &lt;Redirect to=&quot;/login&quot; /&gt;; // 未认证时重定向到登录页面</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &lt;WrappedComponent &#123;...props&#125; /&gt;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return AuthenticatedComponent;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default withAuth;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">src/components/Dashboard.js</span><br><span class="line"></span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import withAuth from &#x27;../hocs/withAuth&#x27;;</span><br><span class="line"></span><br><span class="line">const Dashboard = () =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Dashboard&lt;/h1&gt;</span><br><span class="line">      &lt;p&gt;Welcome to your dashboard!&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default withAuth(Dashboard);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">src/components/Login.js</span><br><span class="line"></span><br><span class="line">import React, &#123; useState &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; useHistory &#125; from &#x27;react-router-dom&#x27;;</span><br><span class="line"></span><br><span class="line">const Login = () =&gt; &#123;</span><br><span class="line">  const [username, setUsername] = useState(&#x27;&#x27;);</span><br><span class="line">  const [password, setPassword] = useState(&#x27;&#x27;);</span><br><span class="line">  const history = useHistory();</span><br><span class="line"></span><br><span class="line">  const handleLogin = () =&gt; &#123;</span><br><span class="line">    // 模拟登录逻辑</span><br><span class="line">    if (username === &#x27;admin&#x27; &amp;&amp; password === &#x27;password&#x27;) &#123;</span><br><span class="line">      localStorage.setItem(&#x27;authToken&#x27;, &#x27;some-auth-token&#x27;);</span><br><span class="line">      history.push(&#x27;/dashboard&#x27;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      alert(&#x27;Invalid credentials&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Login&lt;/h1&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type=&quot;text&quot;</span><br><span class="line">        placeholder=&quot;Username&quot;</span><br><span class="line">        value=&#123;username&#125;</span><br><span class="line">        onChange=&#123;(e) =&gt; setUsername(e.target.value)&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type=&quot;password&quot;</span><br><span class="line">        placeholder=&quot;Password&quot;</span><br><span class="line">        value=&#123;password&#125;</span><br><span class="line">        onChange=&#123;(e) =&gt; setPassword(e.target.value)&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">      &lt;button onClick=&#123;handleLogin&#125;&gt;Login&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default Login;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">src/App.js</span><br><span class="line"></span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; BrowserRouter as Router, Route, Switch, Redirect &#125; from &#x27;react-router-dom&#x27;;</span><br><span class="line">import Login from &#x27;./components/Login&#x27;;</span><br><span class="line">import Dashboard from &#x27;./components/Dashboard&#x27;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;Router&gt;</span><br><span class="line">      &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">          &lt;Route path=&quot;/login&quot; component=&#123;Login&#125; /&gt;</span><br><span class="line">          &lt;Route path=&quot;/dashboard&quot; component=&#123;Dashboard&#125; /&gt;</span><br><span class="line">          &lt;Redirect from=&quot;/&quot; to=&quot;/login&quot; /&gt;</span><br><span class="line">        &lt;/Switch&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="自定义-Hook-useFetch-处理-ajax-请求"><a href="#自定义-Hook-useFetch-处理-ajax-请求" class="headerlink" title="自定义 Hook (useFetch 处理 ajax 请求)"></a>自定义 Hook (useFetch 处理 ajax 请求)</h3><p>当然！自定义 Hook 是 React 中一种强大的工具，可以让你在不同的组件之间复用逻辑。useFetch 是一个常见的自定义 Hook，用于处理数据获取（AJAX 请求）。下面是一个详细的 useFetch 自定义 Hook 的示例，包括如何使用它来获取数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// src/hooks/useFetch.js</span><br><span class="line">import &#123; useState, useEffect &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">const useFetch = (url, options = &#123;&#125;) =&gt; &#123;</span><br><span class="line">  const [data, setData] = useState(null);</span><br><span class="line">  const [loading, setLoading] = useState(true);</span><br><span class="line">  const [error, setError] = useState(null);</span><br><span class="line"></span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    let isMounted = true;</span><br><span class="line">    const controller = new AbortController();</span><br><span class="line">    const signal = controller.signal;</span><br><span class="line"></span><br><span class="line">    const fetchData = async () =&gt; &#123;</span><br><span class="line">      try &#123;</span><br><span class="line">        const response = await fetch(url, &#123; ...options, signal &#125;);</span><br><span class="line">        if (!response.ok) &#123;</span><br><span class="line">          throw new Error(`HTTP error! status: $&#123;response.status&#125;`);</span><br><span class="line">        &#125;</span><br><span class="line">        const result = await response.json();</span><br><span class="line">        if (isMounted) &#123;</span><br><span class="line">          setData(result);</span><br><span class="line">          setLoading(false);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; catch (err) &#123;</span><br><span class="line">        if (isMounted &amp;&amp; err.name !== &#x27;AbortError&#x27;) &#123;</span><br><span class="line">          setError(err);</span><br><span class="line">          setLoading(false);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    fetchData();</span><br><span class="line"></span><br><span class="line">    return () =&gt; &#123;</span><br><span class="line">      isMounted = false;</span><br><span class="line">      controller.abort();</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [url, options]);</span><br><span class="line"></span><br><span class="line">  return &#123; data, loading, error &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default useFetch;</span><br><span class="line"></span><br><span class="line">// src/components/DataFetcher.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import useFetch from &#x27;../hooks/useFetch&#x27;;</span><br><span class="line"></span><br><span class="line">const DataFetcher = () =&gt; &#123;</span><br><span class="line">  const &#123; data, loading, error &#125; = useFetch(&#x27;https://api.example.com/data&#x27;);</span><br><span class="line"></span><br><span class="line">  if (loading) &#123;</span><br><span class="line">    return &lt;div&gt;Loading...&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (error) &#123;</span><br><span class="line">    return &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Data Fetched&lt;/h1&gt;</span><br><span class="line">      &lt;pre&gt;&#123;JSON.stringify(data, null, 2)&#125;&lt;/pre&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default DataFetcher;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// src/components/DataFetcher.js</span><br><span class="line">import React, &#123; useState &#125; from &#x27;react&#x27;;</span><br><span class="line">import useFetch from &#x27;../hooks/useFetch&#x27;;</span><br><span class="line"></span><br><span class="line">const DataFetcher = () =&gt; &#123;</span><br><span class="line">  const [data, loading, error] = useFetch(&#x27;https://api.example.com/data&#x27;, &#123;</span><br><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">    body: JSON.stringify(&#123; key: &#x27;value&#x27; &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  if (loading) &#123;</span><br><span class="line">    return &lt;div&gt;Loading...&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (error) &#123;</span><br><span class="line">    return &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Data Fetched&lt;/h1&gt;</span><br><span class="line">      &lt;pre&gt;&#123;JSON.stringify(data, null, 2)&#125;&lt;/pre&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default DataFetcher;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// src/App.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import DataFetcher from &#x27;./components/DataFetcher&#x27;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;DataFetcher /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h3 id="React-中的副作用"><a href="#React-中的副作用" class="headerlink" title="React 中的副作用"></a>React 中的副作用</h3><p>在 React 中，<strong>副作用（side effects）</strong>是指那些与组件渲染逻辑无关的操作。这些操作通常会在组件挂载、更新或卸载时执行，并且可能会对应用程序的状态或外部环境产生影响。常见的副作用包括：</p>
<ol>
<li><strong>数据获取</strong>：从 API 获取数据。</li>
<li><strong>订阅</strong>：订阅事件监听器或其他数据源。</li>
<li><strong>手动修改 DOM</strong>：直接操作 DOM 元素。</li>
<li><strong>记录日志</strong>：将信息输出到控制台。</li>
<li><strong>定时器</strong>：设置和清除定时器。</li>
<li><strong>浏览器存储</strong>：读取或写入 <code>localStorage</code> 或 <code>sessionStorage</code>。</li>
</ol>
<h4 id="为什么需要处理副作用？"><a href="#为什么需要处理副作用？" class="headerlink" title="为什么需要处理副作用？"></a>为什么需要处理副作用？</h4><p>React 的核心理念是通过声明式编程来描述 UI 的样子，即根据当前的状态和属性来决定组件应该渲染什么内容。然而，某些操作不能简单地通过状态和属性的变化来触发，而是需要在特定的时间点（如组件挂载或更新后）执行。这就是为什么我们需要专门的机制来处理副作用。</p>
<h4 id="如何处理副作用？"><a href="#如何处理副作用？" class="headerlink" title="如何处理副作用？"></a>如何处理副作用？</h4><p>在类组件中，副作用通常通过生命周期方法来处理，例如：</p>
<ul>
<li><code>componentDidMount</code>：组件挂载后执行。</li>
<li><code>componentDidUpdate</code>：组件更新后执行。</li>
<li><code>componentWillUnmount</code>：组件卸载前执行。</li>
</ul>
<p>而在函数组件中，React 提供了 <code>useEffect</code> 钩子来处理副作用。<code>useEffect</code> 可以替代类组件中的生命周期方法，并且更加灵活和直观。</p>
<h4 id="useEffect-的工作原理"><a href="#useEffect-的工作原理" class="headerlink" title="useEffect 的工作原理"></a><code>useEffect</code> 的工作原理</h4><p><code>useEffect</code> 接收两个参数：</p>
<ol>
<li><strong>effect 函数</strong>：包含要执行的副作用逻辑。</li>
<li><strong>依赖项数组</strong>：指定哪些状态或属性的变化会触发 effect 函数的重新执行。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 副作用逻辑</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 清理逻辑（可选）</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, [dependencies]); <span class="comment">// 依赖项数组</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果依赖项数组为空 <code>[]</code>，则 effect 只会在组件挂载和卸载时执行。</li>
<li>如果依赖项数组包含某些状态或属性，则 effect 会在这些值变化时执行。</li>
<li>如果没有提供依赖项数组，默认情况下 effect 会在每次渲染后执行。</li>
</ul>
<h4 id="示例：使用-useEffect-处理副作用"><a href="#示例：使用-useEffect-处理副作用" class="headerlink" title="示例：使用 useEffect 处理副作用"></a>示例：使用 <code>useEffect</code> 处理副作用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Count has changed to <span class="subst">$&#123;count&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置定时器</span></span><br><span class="line">    <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setCount</span>(<span class="function"><span class="params">prevCount</span> =&gt;</span> prevCount + <span class="number">1</span>);</span><br><span class="line">    &#125;, <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清理定时器</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Clearing interval&#x27;</span>);</span><br><span class="line">      <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [count]); <span class="comment">// 依赖项数组</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MyComponent</span>;</span><br></pre></td></tr></table></figure>

<p>在这个例子中：</p>
<ul>
<li><code>useEffect</code> 在 <code>count</code> 发生变化时执行。</li>
<li>它设置了每 5 秒增加一次 <code>count</code> 的定时器。</li>
<li>当组件卸载或 <code>count</code> 再次变化时，清理定时器以避免内存泄漏。</li>
</ul>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li><strong>副作用</strong> 是指那些与组件渲染逻辑无关的操作，如数据获取、订阅、手动修改 DOM 等。</li>
<li>在类组件中，副作用通常通过生命周期方法处理；在函数组件中，使用 <code>useEffect</code> 钩子来处理副作用。</li>
<li><code>useEffect</code> 提供了一种灵活且直观的方式来管理副作用，确保它们在适当的时间点执行并进行清理。</li>
</ul>
<h3 id="什么时候用函数组件什么时候用-class组件"><a href="#什么时候用函数组件什么时候用-class组件" class="headerlink" title="什么时候用函数组件什么时候用 class组件"></a>什么时候用函数组件什么时候用 class组件</h3><p>在 React 中，选择使用函数组件还是类组件取决于具体的需求和场景。随着 React Hooks 的引入，函数组件的功能已经非常强大，可以满足大多数场景的需求。以下是选择使用函数组件或类组件的一些指导原则：</p>
<ul>
<li>使用函数组件的情况</li>
</ul>
<ol>
<li><p><strong>简单状态管理</strong>：</p>
<ul>
<li>当组件的状态逻辑相对简单时，使用函数组件和 <code>useState</code> 钩子来管理状态。</li>
<li>示例：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>不需要生命周期方法</strong>：</p>
<ul>
<li>如果组件不需要使用生命周期方法（如 <code>componentDidMount</code>、<code>componentDidUpdate</code> 等），函数组件是一个更好的选择。</li>
<li>使用 <code>useEffect</code> 钩子可以处理副作用和生命周期相关的逻辑。</li>
</ul>
</li>
<li><p><strong>更好的性能</strong>：</p>
<ul>
<li>函数组件通常比类组件性能更好，因为它们没有实例化对象的开销。</li>
</ul>
</li>
<li><p><strong>更简洁的代码</strong>：</p>
<ul>
<li>函数组件的代码通常更简洁，易于阅读和维护。</li>
</ul>
</li>
<li><p><strong>Hooks 的丰富功能</strong>：</p>
<ul>
<li>使用 <code>useReducer</code>、<code>useContext</code>、<code>useMemo</code>、<code>useCallback</code> 等 Hooks 可以实现复杂的状态管理和优化。</li>
</ul>
</li>
</ol>
<ul>
<li>使用类组件的情况</li>
</ul>
<ol>
<li><p><strong>复杂的生命周期逻辑</strong>：</p>
<ul>
<li>如果组件需要复杂的生命周期逻辑，类组件可能更合适。</li>
<li>虽然 <code>useEffect</code> 可以处理大部分生命周期逻辑，但在某些复杂场景下，类组件的生命周期方法可能更直观。</li>
</ul>
</li>
<li><p><strong>需要使用 <code>this</code> 关键字</strong>：</p>
<ul>
<li>如果组件需要使用 <code>this</code> 关键字来访问组件实例的方法或属性，类组件是一个更好的选择。</li>
<li>虽然可以通过 <code>useRef</code> 来实现类似的功能，但类组件的 <code>this</code> 更加直观。</li>
</ul>
</li>
<li><p><strong>代码迁移</strong>：</p>
<ul>
<li>如果项目中已经存在大量的类组件，为了保持一致性，可能需要继续使用类组件。</li>
<li>逐步将类组件迁移到函数组件也是一个可行的策略。</li>
</ul>
</li>
<li><p><strong>团队习惯</strong>：</p>
<ul>
<li>如果团队更熟悉类组件的编写方式，可能需要继续使用类组件。</li>
<li>逐步引入 Hooks 并迁移到函数组件可以减少团队的学习成本。</li>
</ul>
</li>
</ol>
<ul>
<li><p>示例对比</p>
</li>
<li><p>函数组件示例</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Timer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [seconds, setSeconds] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> interval = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setSeconds</span>(<span class="function"><span class="params">prevSeconds</span> =&gt;</span> prevSeconds + <span class="number">1</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearInterval</span>(interval);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Seconds: &#123;seconds&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>类组件示例</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Timer</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">seconds</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">interval</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function"><span class="params">prevState</span> =&gt;</span> (&#123; <span class="attr">seconds</span>: prevState.<span class="property">seconds</span> + <span class="number">1</span> &#125;));</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">interval</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Seconds: &#123;this.state.seconds&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>总结</p>
</li>
<li><p><strong>函数组件</strong>：</p>
<ul>
<li>适用于大多数场景。</li>
<li>代码更简洁，易于维护。</li>
<li>支持 Hooks，功能强大。</li>
</ul>
</li>
<li><p><strong>类组件</strong>：</p>
<ul>
<li>适用于复杂的生命周期逻辑。</li>
<li>适用于需要使用 <code>this</code> 关键字的场景。</li>
<li>适用于代码迁移和团队习惯。</li>
</ul>
</li>
</ul>
<p>随着 React Hooks 的不断成熟和优化，函数组件已经成为 React 开发中的主流选择。但在某些特定场景下，类组件仍然有其适用性。根据具体需求和团队习惯来选择合适的组件类型。</p>
<h3 id="react-中ajax-放在那个生命周期里面处理更合适"><a href="#react-中ajax-放在那个生命周期里面处理更合适" class="headerlink" title="react 中ajax 放在那个生命周期里面处理更合适"></a>react 中ajax 放在那个生命周期里面处理更合适</h3><p>在类组件中，通常使用 componentDidMount 生命周期方法来处理 AJAX 请求。这是因为 componentDidMount 在组件挂载到 DOM 后立即调用，是进行数据获取的理想时机。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">class DataFetcher extends Component &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      data: null,</span><br><span class="line">      loading: true,</span><br><span class="line">      error: null</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    fetch(&#x27;https://api.example.com/data&#x27;)</span><br><span class="line">      .then(response =&gt; response.json())</span><br><span class="line">      .then(data =&gt; this.setState(&#123; data, loading: false &#125;))</span><br><span class="line">      .catch(error =&gt; this.setState(&#123; error, loading: false &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; data, loading, error &#125; = this.state;</span><br><span class="line"></span><br><span class="line">    if (loading) &#123;</span><br><span class="line">      return &lt;div&gt;Loading...&lt;/div&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (error) &#123;</span><br><span class="line">      return &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Data Fetched&lt;/h1&gt;</span><br><span class="line">        &lt;pre&gt;&#123;JSON.stringify(data, null, 2)&#125;&lt;/pre&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default DataFetcher;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>函数组件<br>在函数组件中，使用 useEffect Hook 来处理 AJAX 请求。useEffect 可以替代类组件中的生命周期方法，并且更加灵活。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import React, &#123; useState, useEffect &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function DataFetcher() &#123;</span><br><span class="line">  const [data, setData] = useState(null);</span><br><span class="line">  const [loading, setLoading] = useState(true);</span><br><span class="line">  const [error, setError] = useState(null);</span><br><span class="line"></span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    fetch(&#x27;https://api.example.com/data&#x27;)</span><br><span class="line">      .then(response =&gt; response.json())</span><br><span class="line">      .then(data =&gt; &#123;</span><br><span class="line">        setData(data);</span><br><span class="line">        setLoading(false);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(error =&gt; &#123;</span><br><span class="line">        setError(error);</span><br><span class="line">        setLoading(false);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;, []); // 空依赖数组表示只在组件挂载时执行一次</span><br><span class="line"></span><br><span class="line">  if (loading) &#123;</span><br><span class="line">    return &lt;div&gt;Loading...&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (error) &#123;</span><br><span class="line">    return &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Data Fetched&lt;/h1&gt;</span><br><span class="line">      &lt;pre&gt;&#123;JSON.stringify(data, null, 2)&#125;&lt;/pre&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default DataFetcher;</span><br></pre></td></tr></table></figure>


<p>如果需要在组件卸载时取消 AJAX 请求（例如，使用 AbortController），可以在 useEffect 中返回一个清理函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">useEffect(() =&gt; &#123;</span><br><span class="line">  const controller = new AbortController();</span><br><span class="line">  const signal = controller.signal;</span><br><span class="line"></span><br><span class="line">  fetch(&#x27;https://api.example.com/data&#x27;, &#123; signal &#125;)</span><br><span class="line">    .then(response =&gt; response.json())</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">      setData(data);</span><br><span class="line">      setLoading(false);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(error =&gt; &#123;</span><br><span class="line">      if (error.name === &#x27;AbortError&#x27;) &#123;</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      setError(error);</span><br><span class="line">      setLoading(false);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  return () =&gt; &#123;</span><br><span class="line">    controller.abort();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, []);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="vue-中ajax-放在那个生命周期里面处理更合适"><a href="#vue-中ajax-放在那个生命周期里面处理更合适" class="headerlink" title="vue 中ajax 放在那个生命周期里面处理更合适"></a>vue 中ajax 放在那个生命周期里面处理更合适</h3><p>在 Vue 2 中，通常使用 created 或 mounted 生命周期钩子来处理 AJAX 请求。</p>
<p>在 Vue 3 中，推荐使用组合式 API (setup 函数) 来处理 AJAX 请求。setup 函数在组件创建之前执行，类似于 Vue 2 的 beforeCreate 钩子，但更推荐在 setup 中进行数据获取。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">// Vue 2</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      data: null,</span><br><span class="line">      loading: true,</span><br><span class="line">      error: null,</span><br><span class="line">      controller: null</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.controller = new AbortController();</span><br><span class="line">    const signal = this.controller.signal;</span><br><span class="line"></span><br><span class="line">    fetch(&#x27;https://api.example.com/data&#x27;, &#123; signal &#125;)</span><br><span class="line">      .then(response =&gt; response.json())</span><br><span class="line">      .then(data =&gt; &#123;</span><br><span class="line">        this.data = data;</span><br><span class="line">        this.loading = false;</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(error =&gt; &#123;</span><br><span class="line">        if (error.name === &#x27;AbortError&#x27;) &#123;</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        this.error = error;</span><br><span class="line">        this.loading = false;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeDestroy() &#123;</span><br><span class="line">    this.controller.abort();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Vue 3</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div v-if=&quot;loading&quot;&gt;Loading...&lt;/div&gt;</span><br><span class="line">    &lt;div v-else-if=&quot;error&quot;&gt;Error: &#123;&#123; error.message &#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;div v-else&gt;</span><br><span class="line">      &lt;h1&gt;Data Fetched&lt;/h1&gt;</span><br><span class="line">      &lt;pre&gt;&#123;&#123; data &#125;&#125;&lt;/pre&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const data = ref(null);</span><br><span class="line">    const loading = ref(true);</span><br><span class="line">    const error = ref(null);</span><br><span class="line"></span><br><span class="line">    // 提前发出 AJAX 请求</span><br><span class="line">    fetch(&#x27;https://api.example.com/data&#x27;)</span><br><span class="line">      .then(response =&gt; response.json())</span><br><span class="line">      .then(data =&gt; &#123;</span><br><span class="line">        data.value = data;</span><br><span class="line">        loading.value = false;</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(error =&gt; &#123;</span><br><span class="line">        error.value = error;</span><br><span class="line">        loading.value = false;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">    // 可选：在组件挂载后执行其他操作</span><br><span class="line">    onMounted(() =&gt; &#123;</span><br><span class="line">      console.log(&#x27;Component has been mounted&#x27;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      data,</span><br><span class="line">      loading,</span><br><span class="line">      error</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="react-中-如何拆分组件更合适"><a href="#react-中-如何拆分组件更合适" class="headerlink" title="react 中 如何拆分组件更合适"></a>react 中 如何拆分组件更合适</h3><p>在 React 中，合理地拆分组件可以提高代码的可维护性、可重用性和可读性。以下是一些关于如何拆分组件的最佳实践和指导原则：</p>
<ol>
<li>单一职责原则 (Single Responsibility Principle)</li>
<li>组件的粒度 </li>
<li>可重用性</li>
<li>逻辑分离</li>
</ol>
<p>ProductList 组件：负责显示产品列表。<br>ProductItem 组件：负责显示单个产品项。<br>ProductFilter 组件：负责产品过滤逻辑。</p>
<ol start="5">
<li>容器组件与展示组件</li>
</ol>
<p>将容器组件（负责数据获取和状态管理）与展示组件（负责渲染UI）分离。</p>
<p>UserContainer 组件：负责获取用户数据并传递给 UserProfile 组件。<br>UserProfile 组件：负责渲染用户信息。</p>
<ol start="6">
<li><p>组合组件</p>
</li>
<li><p>命名规范<br>为组件选择有意义的名称，以便清晰地表达其功能。</p>
</li>
</ol>
<p>示例：<br>LoginForm：表示登录表单组件。<br>ProductGallery：表示产品画廊组件。<br>NotificationBar：表示通知栏组件。</p>
<ol start="8">
<li><p>避免深层嵌套<br>尽量避免组件嵌套过深，过深的嵌套会使代码难以理解和维护。</p>
</li>
<li><p>使用高阶组件 (HOC) 或自定义 Hooks<br>对于可复用的逻辑，可以使用高阶组件或自定义 Hooks。</p>
</li>
</ol>
<p>withAuth HOC：用于处理认证逻辑。<br>useFetch 自定义 Hook：用于处理数据获取逻辑。</p>
<ol start="10">
<li>遵循文件结构<br>保持一致的文件结构，便于查找和管理组件。</li>
</ol>
<h3 id="react-移动端ui-组件库有哪些"><a href="#react-移动端ui-组件库有哪些" class="headerlink" title="react 移动端ui 组件库有哪些"></a>react 移动端ui 组件库有哪些</h3><p><a target="_blank" rel="noopener" href="https://ant-design-mobile.antgroup.com/zh/components/button#button">https://ant-design-mobile.antgroup.com/zh/components/button#button</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/26/english/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/26/english/" class="post-title-link" itemprop="url">english</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-26 08:55:08" itemprop="dateCreated datePublished" datetime="2024-12-26T08:55:08+08:00">2024-12-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/english/" itemprop="url" rel="index"><span itemprop="name">english</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="English-for-Technical-Interviews"><a href="#English-for-Technical-Interviews" class="headerlink" title="English-for-Technical-Interviews"></a>English-for-Technical-Interviews</h3><h3 id="02-two-sum"><a href="#02-two-sum" class="headerlink" title="02-two sum"></a>02-two sum</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11h4y1P7Yp/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV11h4y1P7Yp/?spm_id_from=333.999.0.0</a> 视频链接<br><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/two-sum/">https://leetcode.cn/problems/two-sum/</a> 题目链接<br><a target="_blank" rel="noopener" href="https://www.collinsdictionary.com/dictionary/">https://www.collinsdictionary.com/dictionary/</a> 我喜欢的英文在线字典</p>
<ul>
<li>Vocabulary</li>
</ul>
<table>
<thead>
<tr>
<th>英文</th>
<th>中文</th>
<th>音标</th>
<th>重要程度</th>
</tr>
</thead>
<tbody><tr>
<td>brute force method</td>
<td>暴力法</td>
<td>bruːt fɔːʳs</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>time complexity</td>
<td>时间复杂度</td>
<td>kəmpleksɪti</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>n squared</td>
<td>n 的平方</td>
<td>skweəʳd</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>length</td>
<td>长度</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>array</td>
<td>数组</td>
<td>əreɪ</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>element</td>
<td>元素</td>
<td>elɪmənt</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>store</td>
<td>存储</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>key-value pair</td>
<td>键值对</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>iterate over &#x2F; go through this array</td>
<td>遍历这个数组</td>
<td>ɪtəˌreɪt</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>sum up to</td>
<td>总和为</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>add &#x2F; plus</td>
<td>加上</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>index &#x2F; indices</td>
<td>索引 （单&#x2F;复）</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>declare a variable</td>
<td>声明一个变量</td>
<td>dɪkleəʳ</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>is equal to &#x2F; equals</td>
<td>等于</td>
<td>iːkwəl</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>minus</td>
<td>减去</td>
<td>maɪnəs</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>combination</td>
<td>组合</td>
<td>kɒmbɪneɪʃən</td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>Repeat the same steps</td>
<td>重复同样的步骤</td>
<td></td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>In this case</td>
<td>在这种情况下</td>
<td></td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>by default</td>
<td>默认</td>
<td>dɪfɔːlt</td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>find out</td>
<td>发现</td>
<td></td>
<td>🌟🌟</td>
</tr>
<tr>
<td>difference</td>
<td>差值</td>
<td></td>
<td>🌟🌟</td>
</tr>
<tr>
<td>move on to</td>
<td>移动到</td>
<td></td>
<td>🌟🌟</td>
</tr>
</tbody></table>
<ul>
<li><p>Script</p>
</li>
<li><p>Explain How to Use Brute Force</p>
</li>
</ul>
<p>We have two solutions here. The first one is using brute force method<br>which has the time complexity: n squared. The solution is that we check out every combination of 2 values and see if they can sum up to our targeting value<br>which is 8. For example, if we start at 3 then we check every combination<br>that includes 3<br>and see if any of the numbers added to 3<br>so their sum is the target. In this case none of them works.<br>So we start from 2<br>repeat the same steps,<br>and we found out the combination of 2 and 6<br>their sum is exactly 8.<br>So we can just directly return their indices<br>which is 1 and 3.</p>
<ul>
<li>Explain Brute Force Code</li>
</ul>
<p>OK for this brutal force method,<br>the code goes here.<br>So firstly we are going to declare a variable called n,<br>which represents the length of the nums array.<br>So as we’re gonna check out<br>every combination of two elements from this array,<br>so we’re gonna use a nested for loop to do so.<br>Inside we have every combination and we will check<br>if the sum of these two elements is equal to a target. If so<br>then<br>we can just directly return the two indices of these numbers<br>and if not at the end of the program<br>we will just return an empty array by default.</p>
<ul>
<li>Explain How to Use HashMap</li>
</ul>
<p>The second solution is to use hash map<br>which has time complexity about O(N). So<br>we’re gonna use this hash map to store key-value pairs<br>where the key is the element,<br>and the value is the index of this element.<br>Then we iterate over this array from the first element 3.<br>Because now<br>we are looking for 5 as 3 plus 5 equals 8,<br>so we will try to check if the map has already<br>stored five inside.<br>Unfortunately no,<br>so we store the current<br>element and it is index in the map for future usage.</p>
<p>Now we can move on to the next element 2<br>as the difference between the<br>target 8 and the current element 2 is 6.<br>But the map doesn’t have it, so we still<br>store the element and its index.</p>
<p>Move on to 1. Same thing happened we still need to<br>store the one and its index.</p>
<p>But things are different for six,<br>as now we’re looking for<br>8 minus 6 equals 2 and the map has 2 inside.<br>So we can use map<br>get to get its index, and now we just returned 1 and 3.</p>
<ul>
<li>Explain HashMap Code</li>
</ul>
<p>If we want to use hash map,<br>then basically we need to declare a map,<br>where the key<br>is an integer representing for the element and value is the index.<br>We iterates over the array, and for each element,<br>we gonna calculate<br>the difference between the target and the current element.<br>We’re gonna check<br>if the difference value word exists in this map or not.<br>If so, then<br>also we just directly return the two indices.<br>If not we simply put the element and it’s<br>index in the map.</p>
<p>At the end of the program<br>we need to return an empty array by default</p>
<h3 id="03-Spoken-English"><a href="#03-Spoken-English" class="headerlink" title="03 - Spoken English"></a>03 - Spoken English</h3><ul>
<li><p>Resources</p>
</li>
<li><p>发音 &amp; 音标<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Gs41127iG/?spm_id_from=333.337.search-card.all.click&vd_source=1b467c44a301cea703059eb872a93c8d">https://www.bilibili.com/video/BV1Gs41127iG/?spm_id_from=333.337.search-card.all.click&amp;vd_source=1b467c44a301cea703059eb872a93c8d</a> BBC 发音教程全集</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1ma4y1L7NE/?spm_id_from=333.337.search-card.all.click&vd_source=1b467c44a301cea703059eb872a93c8d">https://www.bilibili.com/video/BV1ma4y1L7NE/?spm_id_from=333.337.search-card.all.click&amp;vd_source=1b467c44a301cea703059eb872a93c8d</a> BBC 六分钟英语第一季合辑</p>
<ul>
<li>连读 &amp; 表达<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1D7411n7bS/?spm_id_from=333.337.top_right_bar_window_default_collection.content.click&vd_source=1b467c44a301cea703059eb872a93c8d">https://www.bilibili.com/video/BV1D7411n7bS/?spm_id_from=333.337.top_right_bar_window_default_collection.content.click&amp;vd_source=1b467c44a301cea703059eb872a93c8d</a> BBC 经典教程 | 连读 | 语音语调全集</li>
</ul>
<p>老友记，优酷或者腾讯视频</p>
<h3 id="04-reverse-list"><a href="#04-reverse-list" class="headerlink" title="04 - reverse list"></a>04 - reverse list</h3><ul>
<li>Vocabulary</li>
</ul>
<table>
<thead>
<tr>
<th>英文</th>
<th>中文</th>
<th>音标</th>
<th>重要程度</th>
</tr>
</thead>
<tbody><tr>
<td>plenty of</td>
<td>很多</td>
<td>plenti</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>head node</td>
<td>头节点</td>
<td>hed noʊd</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>tail node</td>
<td>尾节点</td>
<td>teɪl</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>pointer</td>
<td>指针</td>
<td>pɔɪntəʳ</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>points to</td>
<td>指向</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>push &#x2F; add</td>
<td>推入（栈中）</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>pop out</td>
<td>拿出（栈中）</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>reverse</td>
<td>反转</td>
<td>rɪvɜːʳs</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>iterate over &#x2F; go through this linked list</td>
<td>遍历这个链表</td>
<td>ɪtəˌreɪt</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>recursive method</td>
<td>递归法</td>
<td>rɪˈkɜrsɪv</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>iterative method</td>
<td>迭代法</td>
<td>ˈɪtərətɪv</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>singly linked list</td>
<td>单向链表</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>doubly linked list</td>
<td>双向链表</td>
<td></td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>cycle</td>
<td>循环，圈</td>
<td>saɪkəl</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>otherwise</td>
<td>否则</td>
<td>ʌðəʳwaɪz</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>original</td>
<td>原来的，原本的</td>
<td>ərɪdʒɪnəl</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>in the normal case</td>
<td>一般情况下</td>
<td></td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>the rest of …</td>
<td>xx 的剩余部分</td>
<td></td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>meanwhile …</td>
<td>同时</td>
<td>miːnhwaɪl</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>reaches the end of the linked list …</td>
<td>来到了链表的结尾</td>
<td></td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>eventually &#x2F; finally</td>
<td>最终</td>
<td>ɪventʃuəli</td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>a key takeaway</td>
<td>一个关键要点</td>
<td></td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>accordingly</td>
<td>有根据地</td>
<td></td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>eliminate</td>
<td>消除</td>
<td>ɪlɪmɪneɪt</td>
<td>🌟🌟🌟</td>
</tr>
<tr>
<td>repeat over and over again until…</td>
<td>一直重复，直到…</td>
<td></td>
<td>🌟🌟🌟</td>
</tr>
</tbody></table>
<ul>
<li>Script</li>
</ul>
<h3 id="05-resume"><a href="#05-resume" class="headerlink" title="05 - resume"></a>05 - resume</h3><ul>
<li>Vocabulary</li>
</ul>
<table>
<thead>
<tr>
<th>英文</th>
<th>中文</th>
<th>音标</th>
</tr>
</thead>
<tbody><tr>
<td>design</td>
<td>设计</td>
<td>dɪzaɪn</td>
</tr>
<tr>
<td>implement</td>
<td>实现</td>
<td>ɪmplɪment</td>
</tr>
<tr>
<td>build &#x2F; establish</td>
<td>搭建</td>
<td>bɪld &#x2F; ɪstæblɪʃ</td>
</tr>
<tr>
<td>develop</td>
<td>实现</td>
<td>dɪveləp</td>
</tr>
<tr>
<td>reduce &#x2F; decrease</td>
<td>降低，减少</td>
<td>dɪkriːs</td>
</tr>
<tr>
<td>enhance &#x2F; increase</td>
<td>提高，增加</td>
<td>ɪnhɑːns &#x2F; ɪnkriːs</td>
</tr>
<tr>
<td>improve</td>
<td>提升，完善</td>
<td>ɪmpruːv</td>
</tr>
<tr>
<td>optimize</td>
<td>优化</td>
<td>ɒptɪmaɪz</td>
</tr>
<tr>
<td>significantly &#x2F; greatly</td>
<td>极大地</td>
<td>sɪgnɪfɪkənt &#x2F; greɪtli</td>
</tr>
<tr>
<td>automate, automated</td>
<td>自动化</td>
<td>ɔːtəmeɪt</td>
</tr>
<tr>
<td>result in</td>
<td>导致…的结果</td>
<td>ɪtəˌreɪt</td>
</tr>
<tr>
<td>user experience</td>
<td>用户体验</td>
<td>juːzəʳ ɪkspɪəriəns</td>
</tr>
<tr>
<td>independently</td>
<td>独立地</td>
<td>ɪndɪpendənt</td>
</tr>
<tr>
<td>seamless</td>
<td>无缝的</td>
<td>siːmləs</td>
</tr>
<tr>
<td>accelerate &#x2F; facilitate</td>
<td>加速，帮助</td>
<td>ækseləreɪt &#x2F; fəsɪlɪteɪt</td>
</tr>
<tr>
<td>robust</td>
<td>鲁棒性强的</td>
<td>roʊbʌst</td>
</tr>
<tr>
<td>stable</td>
<td>稳定的</td>
<td>steɪbəl</td>
</tr>
<tr>
<td>reliable</td>
<td>可靠的</td>
<td>rɪlaɪəbəl</td>
</tr>
<tr>
<td>extensible &#x2F; scalable</td>
<td>可扩展的</td>
<td>ɪkˈstɛnsəbəl &#x2F; skeɪləbəl</td>
</tr>
<tr>
<td>standardized</td>
<td>标准的</td>
<td>stændəʳdaɪz</td>
</tr>
<tr>
<td>consistent</td>
<td>一致性的</td>
<td>kənsɪstənt</td>
</tr>
<tr>
<td>persistent</td>
<td>持久性的</td>
<td>pəʳsɪstənt</td>
</tr>
<tr>
<td>effective</td>
<td>有效的</td>
<td>ɪfektɪv</td>
</tr>
<tr>
<td>efficient</td>
<td>有效率的</td>
<td>ɪfɪʃənt</td>
</tr>
<tr>
<td>isolated</td>
<td>隔离的，独立的</td>
<td>aɪsəleɪtɪd</td>
</tr>
<tr>
<td>standalone</td>
<td>独立的</td>
<td></td>
</tr>
<tr>
<td>reusable</td>
<td>可重复利用的</td>
<td>riːjuːzəbəl</td>
</tr>
<tr>
<td>portable</td>
<td>便捷的</td>
<td>pɔːʳtəbəl</td>
</tr>
<tr>
<td>integrate, integrated</td>
<td>集成</td>
<td>ɪntɪgreɪt</td>
</tr>
<tr>
<td>development lifecycle</td>
<td>开发周期</td>
<td></td>
</tr>
<tr>
<td>metrics</td>
<td>指标</td>
<td>ˈmɛtrɪks</td>
</tr>
<tr>
<td>alert</td>
<td>告警</td>
<td>əlɜːʳt</td>
</tr>
<tr>
<td>monitoring system</td>
<td>监控系统</td>
<td>ˈmɒnɪtərɪŋ</td>
</tr>
<tr>
<td>incident</td>
<td>事故</td>
<td>ɪnsɪdənt</td>
</tr>
<tr>
<td>deployment</td>
<td>部署</td>
<td>dɪplɔɪmənt</td>
</tr>
<tr>
<td>transition</td>
<td>过渡</td>
<td>trænzɪʃən</td>
</tr>
<tr>
<td>achieve &#x2F; reach</td>
<td>达到，达成</td>
<td>ətʃiːv &#x2F; riːtʃ</td>
</tr>
<tr>
<td>allow&#x2F;enable users to do sth.</td>
<td>允许用户做某事</td>
<td></td>
</tr>
<tr>
<td>cross-platform</td>
<td>跨平台的</td>
<td>ɪlɪmɪneɪt</td>
</tr>
<tr>
<td>platform</td>
<td>平台</td>
<td>plætfɔːʳm</td>
</tr>
<tr>
<td>in production</td>
<td>在生产环境中</td>
<td>prədʌkʃən</td>
</tr>
<tr>
<td>maintain</td>
<td>维护</td>
<td>meɪnteɪn</td>
</tr>
<tr>
<td>own</td>
<td>负责，拥有</td>
<td>oʊn</td>
</tr>
<tr>
<td>capability</td>
<td>能力</td>
<td>capability</td>
</tr>
<tr>
<td>end-to-end</td>
<td>端到端的</td>
<td></td>
</tr>
<tr>
<td>manual efforts</td>
<td>手动工作</td>
<td>mænjuəl efəʳts</td>
</tr>
<tr>
<td>introduce</td>
<td>引入（框架，工具等）</td>
<td>ɪntrədjuːs</td>
</tr>
<tr>
<td>customized</td>
<td>自定义的</td>
<td>kʌstəˌmaɪzd</td>
</tr>
</tbody></table>
<h3 id="06-lc-113"><a href="#06-lc-113" class="headerlink" title="06 - lc 113"></a>06 - lc 113</h3><ul>
<li>Vocabulary</li>
</ul>
<table>
<thead>
<tr>
<th>英文</th>
<th>中文</th>
<th>重要程度</th>
</tr>
</thead>
<tbody><tr>
<td>DFS &#x2F; Depth-First-Search</td>
<td>深度优先遍历</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Backtrack</td>
<td>回溯</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Path</td>
<td>路径</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Node</td>
<td>节点</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Leaf Node</td>
<td>叶子节点</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Tree Traversal</td>
<td>树的遍历</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Global variable</td>
<td>全局变量</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Initialize</td>
<td>初始化</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Base case</td>
<td>基础情况</td>
<td>🌟🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Dead-end</td>
<td>死路</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Undo</td>
<td>撤回</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Explore</td>
<td>探索</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Hit &#x2F; reach</td>
<td>碰到 &#x2F; 达到</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Track</td>
<td>追踪，跟踪</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Terminate</td>
<td>使…结束</td>
<td>🌟🌟🌟🌟</td>
</tr>
<tr>
<td>Crucial</td>
<td>关键的</td>
<td>🌟🌟🌟</td>
</tr>
</tbody></table>
<ul>
<li>Script</li>
</ul>
<p>Today we will use DFS + backtracking to solve this problem. Basically we need to explore all possible paths from the root node to the leaf node and see if their sum is equal to the target sum. For each node, we use DFS way to track the current sum and all nodes we have gone through. We put those nodes into a list called current path. Once we hit the leaf node, we check if the current sum equals to the target, if so, then we add the current path list to the result to be returned later.<br>So another crucial part is, at the end of the DFS function, we need to remove the last node from the current path list, which is called backtracking. So why we need to remove the last node is that we don’t want to consider this case anymore, either because it led to the dead-end, or they have already been explored. Therefore, we undo this choice and we will explore other paths later.</p>
<p>So before starting the DFS, we need to initialize the targetsum as a global variable. Then in the DFS, we can see the base case for this DFS function is to check if the current node is null. If so, we directly terminate the function.<br>Then we update the current sum by adding the current node’s value, and then update the current path list by adding the current node.<br>Then if the current node is a leaf node, we can check if the overall sum is equal to the target one. If so, that is one of the valid results to be returned, we add it to the result list.<br>If not the leaf node, that means we can keep doing tree traversal to go down. We can either choose to go left or go right. After exploring all possible paths starting from the current node, then we do a backtrack to undo the last node added to the path list, which is just the current node.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">function TreeNode(val, left, right) &#123;</span><br><span class="line">    this.val = (val===undefined ? 0 : val)</span><br><span class="line">    this.left = (left===undefined ? null : left)</span><br><span class="line">    this.right = (right===undefined ? null : right)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Solution &#123;</span><br><span class="line">    constructor() &#123;</span><br><span class="line">        this.ret = [];</span><br><span class="line">        this.path = [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pathSum(root, targetSum) &#123;</span><br><span class="line">        this.dfs(root, targetSum);</span><br><span class="line">        return this.ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dfs(node, targetSum) &#123;</span><br><span class="line">        if (!node) return;</span><br><span class="line"></span><br><span class="line">        this.path.push(node.val);</span><br><span class="line">        targetSum -= node.val;</span><br><span class="line"></span><br><span class="line">        if (!node.left &amp;&amp; !node.right &amp;&amp; targetSum === 0) &#123;</span><br><span class="line">            this.ret.push([...this.path]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.dfs(node.left, targetSum);</span><br><span class="line">        this.dfs(node.right, targetSum);</span><br><span class="line"></span><br><span class="line">        this.path.pop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Helper function to create a binary tree from an array</span><br><span class="line">function arrayToTreeNode(arr) &#123;</span><br><span class="line">    if (!arr || arr.length === 0 || arr[0] === null) return null;</span><br><span class="line"></span><br><span class="line">    const root = new TreeNode(arr[0]);</span><br><span class="line">    const queue = [root];</span><br><span class="line">    let i = 1;</span><br><span class="line"></span><br><span class="line">    while (i &lt; arr.length) &#123;</span><br><span class="line">        const current = queue.shift();</span><br><span class="line"></span><br><span class="line">        if (arr[i] !== null) &#123;</span><br><span class="line">            current.left = new TreeNode(arr[i]);</span><br><span class="line">            queue.push(current.left);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line"></span><br><span class="line">        if (i &lt; arr.length &amp;&amp; arr[i] !== null) &#123;</span><br><span class="line">            current.right = new TreeNode(arr[i]);</span><br><span class="line">            queue.push(current.right);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const solution = new Solution();</span><br><span class="line"></span><br><span class="line">const root = arrayToTreeNode([5, 4, 8, 11, null, 13, 4, 7, 2, null, null, 5, 1]);</span><br><span class="line">const targetSum = 22;</span><br><span class="line">console.log(root)</span><br><span class="line"></span><br><span class="line">console.log(JSON.stringify(root))</span><br><span class="line">console.log(solution.pathSum(root, targetSum)); // Output: [[5,4,11,2],[5,8,4,5]]</span><br><span class="line"></span><br><span class="line">// const root1 = arrayToTreeNode([1, 2, 3]);</span><br><span class="line">// const targetSum1 = 5;</span><br><span class="line">// console.log(solution.pathSum(root1, targetSum1)); // Output: []</span><br><span class="line"></span><br><span class="line">// const root2 = arrayToTreeNode([1, 2]);</span><br><span class="line">// const targetSum2 = 0;</span><br><span class="line">// console.log(solution.pathSum(root2, targetSum2)); // Output: []</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Uu4y1V7Eg/?spm_id_from=333.999.0.0&vd_source=ffda878df0ed45bee1ade91d8f451048">https://www.bilibili.com/video/BV1Uu4y1V7Eg/?spm_id_from=333.999.0.0&amp;vd_source=ffda878df0ed45bee1ade91d8f451048</a></p>
<h3 id="07-英文简历"><a href="#07-英文简历" class="headerlink" title="07 英文简历"></a>07 英文简历</h3><p><img src="/../images/english_01.png"></p>
<h3 id="Resources-1"><a href="#Resources-1" class="headerlink" title="Resources"></a>Resources</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11h4y1P7Yp/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV11h4y1P7Yp/?spm_id_from=333.999.0.0</a> 视频链接</p>
<p><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/path-sum-ii/description/">https://leetcode.cn/problems/path-sum-ii/description/</a> 题目链接</p>
<p><a target="_blank" rel="noopener" href="https://www.collinsdictionary.com/dictionary/">https://www.collinsdictionary.com/dictionary/</a> 我喜欢的英文在线字典</p>
<p>在线真人口语练习网站<br><a target="_blank" rel="noopener" href="https://www.free4talk.com/">https://www.free4talk.com/</a> 可以选择不同的口语 level 的聊天室，免费</p>
<hr>
<p>1、前端英语<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1gg411d7if?spm_id_from=333.788.videopod.sections&vd_source=ffda878df0ed45bee1ade91d8f451048">https://www.bilibili.com/video/BV1gg411d7if?spm_id_from=333.788.videopod.sections&amp;vd_source=ffda878df0ed45bee1ade91d8f451048</a></p>
<p>2、英语句子背诵<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1eM411a7dB/?spm_id_from=333.337.search-card.all.click&vd_source=ffda878df0ed45bee1ade91d8f451048">https://www.bilibili.com/video/BV1eM411a7dB/?spm_id_from=333.337.search-card.all.click&amp;vd_source=ffda878df0ed45bee1ade91d8f451048</a></p>
<p>3、前端 React 程序员<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1tm411R7Qt/?spm_id_from=333.337.search-card.all.click&vd_source=ffda878df0ed45bee1ade91d8f451048">https://www.bilibili.com/video/BV1tm411R7Qt/?spm_id_from=333.337.search-card.all.click&amp;vd_source=ffda878df0ed45bee1ade91d8f451048</a></p>
<p>5、程序员英语训练营<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1wM4y1C7LE/?spm_id_from=333.337.search-card.all.click&vd_source=ffda878df0ed45bee1ade91d8f451048">https://www.bilibili.com/video/BV1wM4y1C7LE/?spm_id_from=333.337.search-card.all.click&amp;vd_source=ffda878df0ed45bee1ade91d8f451048</a></p>
<p>6、程序员英语角<br><a target="_blank" rel="noopener" href="https://space.bilibili.com/403317915">https://space.bilibili.com/403317915</a></p>
<p>7、</p>
<p><img src="/../images/englist_01.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Kv4y1E72V/?spm_id_from=333.337.search-card.all.click&vd_source=ffda878df0ed45bee1ade91d8f451048">https://www.bilibili.com/video/BV1Kv4y1E72V/?spm_id_from=333.337.search-card.all.click&amp;vd_source=ffda878df0ed45bee1ade91d8f451048</a></p>
<h3 id="more-frontend-interview-question"><a href="#more-frontend-interview-question" class="headerlink" title="more frontend interview question:"></a>more frontend interview question:</h3><p><a target="_blank" rel="noopener" href="https://johnsonkow.medium.com/general-frontend-interview-questions-e6186ca4bf2b">https://johnsonkow.medium.com/general-frontend-interview-questions-e6186ca4bf2b</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/h5bp/Front-end-Developer-Interview-Questions?tab=readme-ov-file">https://github.com/h5bp/Front-end-Developer-Interview-Questions?tab=readme-ov-file</a></p>
<p><a target="_blank" rel="noopener" href="https://www.interviewbit.com/front-end-developer-interview-questions/#react-js">https://www.interviewbit.com/front-end-developer-interview-questions/#react-js</a></p>
<p><a target="_blank" rel="noopener" href="https://www.usebraintrust.com/hire/interview-questions/front-end-developers">https://www.usebraintrust.com/hire/interview-questions/front-end-developers</a></p>
<p><a target="_blank" rel="noopener" href="https://roadmap.sh/questions/frontend">https://roadmap.sh/questions/frontend</a></p>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/front-end-developer-interview-questions/">https://www.geeksforgeeks.org/front-end-developer-interview-questions/</a></p>
<p>react interview questions:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/wangzhiwei1888/wangzhiwei1888.github.io/tree/master/docs/">https://github.com/wangzhiwei1888/wangzhiwei1888.github.io/tree/master/docs/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/25/node-addon-%E6%89%A9%E5%B1%95-node-c-%E6%89%A9%E5%B1%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/25/node-addon-%E6%89%A9%E5%B1%95-node-c-%E6%89%A9%E5%B1%95/" class="post-title-link" itemprop="url">node addon 扩展 node c++扩展</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-25 10:37:55" itemprop="dateCreated datePublished" datetime="2024-12-25T10:37:55+08:00">2024-12-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/node/" itemprop="url" rel="index"><span itemprop="name">node</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/node/c/" itemprop="url" rel="index"><span itemprop="name">c++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="node-addon-扩展-node-c-扩展"><a href="#node-addon-扩展-node-c-扩展" class="headerlink" title="node addon 扩展 node c++扩展"></a>node addon 扩展 node c++扩展</h1><h2 id="安装-node-gyp"><a href="#安装-node-gyp" class="headerlink" title="安装 node-gyp"></a>安装 node-gyp</h2><p>npm install -g node-gyp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">└── caddon</span><br><span class="line">    ├── binding.gyp</span><br><span class="line">    ├── build</span><br><span class="line">    ├── calculate1.cc</span><br><span class="line">    ├── calculate.cc</span><br><span class="line">    ├── hello.cc</span><br><span class="line">    ├── hello.js</span><br><span class="line">    ├── main.js</span><br><span class="line">    ├── package.json</span><br><span class="line">    └── README.md</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">binding.gyp</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;target_name&quot;: &quot;calculate&quot;,</span><br><span class="line">            &quot;sources&quot;: [ &quot;calculate.cc&quot; ]</span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;target_name&quot;: &quot;calculate1&quot;,</span><br><span class="line">            &quot;sources&quot;: [ &quot;calculate1.cc&quot; ]</span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;target_name&quot;: &quot;hello&quot;,</span><br><span class="line">            &quot;sources&quot;: [ &quot;hello.cc&quot; ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">calculate1.cc</span><br><span class="line"></span><br><span class="line">#include &lt;node.h&gt;</span><br><span class="line"></span><br><span class="line">namespace calculate1 &#123;</span><br><span class="line">    using v8::FunctionCallbackInfo;</span><br><span class="line">    using v8::Isolate;</span><br><span class="line">    using v8::Local;</span><br><span class="line">    using v8::Object;</span><br><span class="line">    using v8::Number;</span><br><span class="line">    using v8::Value;</span><br><span class="line">    using v8::String;</span><br><span class="line">    using v8::Exception;</span><br><span class="line"></span><br><span class="line">    void Method(const FunctionCallbackInfo&lt;Value&gt;&amp;args) &#123;</span><br><span class="line">        Isolate* isolate = args.GetIsolate();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        // 检查参数数量</span><br><span class="line">        if (args.Length() &lt; 2) &#123;</span><br><span class="line">            isolate-&gt;ThrowException(Exception::TypeError(</span><br><span class="line">                String::NewFromUtf8(isolate, &quot;Wrong number of arguments&quot;).ToLocalChecked()));</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!args[0]-&gt;IsNumber() || !args[1]-&gt;IsNumber()) &#123;</span><br><span class="line">            isolate-&gt;ThrowException(Exception::TypeError(</span><br><span class="line">                String::NewFromUtf8(isolate, &quot;Wrong arguments&quot;).ToLocalChecked()));</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        int x = args[0]-&gt;NumberValue(isolate-&gt;GetCurrentContext()).FromJust();</span><br><span class="line">        int y = args[1]-&gt;NumberValue(isolate-&gt;GetCurrentContext()).FromJust();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        int i;</span><br><span class="line">        // double x = 100.734659, y = 353.2313423432;</span><br><span class="line">        for (i=0; i &lt; 100; i++) &#123;</span><br><span class="line">            x += y;</span><br><span class="line">        &#125;</span><br><span class="line">        auto total = Number::New(isolate, x);</span><br><span class="line">        args.GetReturnValue().Set(total);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void Initialize(Local&lt;Object&gt; exports) &#123;</span><br><span class="line">        NODE_SET_METHOD(exports, &quot;calc1&quot;, Method);</span><br><span class="line">    &#125;</span><br><span class="line">    NODE_MODULE(NODE_GYP_MODULE_NAME, Initialize)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main.js</span><br><span class="line"></span><br><span class="line">const calculate = require(&#x27;./build/Release/calculate&#x27;)</span><br><span class="line">const calculate1 = require(&#x27;./build/Release/calculate1&#x27;)</span><br><span class="line">const hello = require(&#x27;./build/Release/hello&#x27;)</span><br><span class="line">const hello_js = require(&#x27;./hello.js&#x27;)</span><br><span class="line"></span><br><span class="line">function calc() &#123;</span><br><span class="line">    let i, x =  100.734659, y=353.2313423432;</span><br><span class="line">    for (i=0; i&lt;1000000000; i++) &#123;</span><br><span class="line">        x += y;</span><br><span class="line">    &#125;</span><br><span class="line">    const total = x</span><br><span class="line">    return total</span><br><span class="line">&#125;</span><br><span class="line">console.log(&#x27;c++ addon result vs Node result&#x27;)</span><br><span class="line">console.log(&#x27;C++ :&#x27; + calculate.calc())</span><br><span class="line">console.log(&#x27;Node :&#x27; + calc())</span><br><span class="line">console.log(&#x27;---------------------------------------&#x27;)</span><br><span class="line">console.log(&#x27;c++ addon vs js addon&#x27;)</span><br><span class="line">console.log(hello.hello())</span><br><span class="line">console.log(hello_js(&#x27;Jack Yeh&#x27;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">console.log(&#x27;c++ addon&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">console.log(&#x27;C++ :&#x27; + calculate1.calc1(100, 100))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">更多参考：https://github.com/wangzhiwei1888/cpp_node_modules.git</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>编译c++</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node-gyp configure</span><br><span class="line">node-gyp build</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node main.js</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">数据结构与算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-24 17:38:43" itemprop="dateCreated datePublished" datetime="2024-12-24T17:38:43+08:00">2024-12-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="数据结构与算法"><a href="#数据结构与算法" class="headerlink" title="数据结构与算法"></a>数据结构与算法</h3><p>可以容纳数据的结构被称为数据结构。<br>算法是用来对数据结构进行处理的方法<br>数据结构是静态的。<br>算法是动态的。</p>
<h3 id="线性数据结构（一维数据结构）"><a href="#线性数据结构（一维数据结构）" class="headerlink" title="线性数据结构（一维数据结构）"></a>线性数据结构（一维数据结构）</h3><p>线性数据结构强调存储与顺序</p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>1、存储在物理空间上是连续的<br>2、底层的数组长度是不可变的<br>3、数组的变量，指向了数组的第一个元素的位置<br>a[1] a[2] []表示存储地址的偏移， 通过偏移查询数据性能最好</p>
<p>优点： 查询数据性能最好<br>缺点：<br>1、因为空间必须得连续，所以如果数组比较大，当空间碎片比较多的时候，容易存不下。<br>2、因为数组的长度是固定的，所以数组的内容难以被添加和删除</p>
<h3 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h3><p>我想传递一个链表，必须传递链表的根节点。<br>每一个节点，都认为自己是根节点</p>
<p>链表的特点：</p>
<p>1、空间上不是连续的。<br>2、没存放一个值，都要多开销一个引用空间。</p>
<p>优点：</p>
<p>1、只要内存足够大，就能存的下，不用担心空间碎片的问题。<br>2、链表的插入和删除操作，非常快。<br>3、链表可以存放任意类型的数据。</p>
<p>缺点：<br>1、查询数据性能差<br>2、链表不能随机访问。<br>3、每个节点都要多开一个引用空间。当节点内数据越大，这部分多开销的内存影响越小</p>
<h3 id="链表的逆置"><a href="#链表的逆置" class="headerlink" title="链表的逆置"></a>链表的逆置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">function Node(val) &#123;</span><br><span class="line">    this.val = val;</span><br><span class="line">    this.next = null;</span><br><span class="line">&#125;</span><br><span class="line">// 遍历链表</span><br><span class="line">function traverseLinkedList(head) &#123;</span><br><span class="line">    let current = head;</span><br><span class="line">    while (current !== null) &#123;</span><br><span class="line">        console.log(current.val); // 访问当前节点的值</span><br><span class="line">        current = current.next;   // 移动到下一个节点</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 迭代方式</span><br><span class="line">function reverseLinkedList(head) &#123;</span><br><span class="line">    let prev = null;</span><br><span class="line">    let current = head;</span><br><span class="line">    while (current !== null) &#123;</span><br><span class="line">        let nextNode = current.next;</span><br><span class="line">        current.next = prev;</span><br><span class="line">        prev = current;</span><br><span class="line">        current = nextNode;</span><br><span class="line">    &#125;</span><br><span class="line">    return prev; // 新的头节点</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 递归方式</span><br><span class="line">function reverseLinkedListRecursive(head) &#123;</span><br><span class="line">    if (head === null || head.next === null) &#123;</span><br><span class="line">        return head;</span><br><span class="line">    &#125;</span><br><span class="line">    let newHead = reverseLinkedListRecursive(head.next);</span><br><span class="line">    head.next.next = head;</span><br><span class="line">    head.next = null;</span><br><span class="line">    return newHead;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var node1 = new Node(1);</span><br><span class="line">var node2 = new Node(2);</span><br><span class="line">var node3 = new Node(3);</span><br><span class="line">var node4 = new Node(4);</span><br><span class="line">var node5 = new Node(5);</span><br><span class="line">node1.next = node2;</span><br><span class="line">node2.next = node3;</span><br><span class="line">node3.next = node4;</span><br><span class="line">node4.next = node5;</span><br><span class="line"></span><br><span class="line">console.log(node1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">console.log(&quot;Original Linked List:&quot;);</span><br><span class="line">traverseLinkedList(node1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// const result = reverseLinkedList(node1);</span><br><span class="line"></span><br><span class="line">// console.log(result);</span><br><span class="line"></span><br><span class="line">// console.log(&quot;Reversed Linked List:&quot;);</span><br><span class="line">// traverseLinkedList(result);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const res1 = reverseLinkedListRecursive(node1);</span><br><span class="line"></span><br><span class="line">console.log(res1);</span><br><span class="line"></span><br><span class="line">console.log(&quot;Reversed Linked List:&quot;);</span><br><span class="line">traverseLinkedList(res1);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><p>时间复杂度分析</p>
<p>最坏情况：<br>当数组是逆序时，冒泡排序需要进行最多的比较和交换操作。<br>外层循环执行 ( n ) 次（其中 ( n ) 是数组的长度）。<br>内层循环在第一次迭代时执行 ( n-1 ) 次，在第二次迭代时执行 ( n-2 ) 次，依此类推，直到最后一次迭代执行 1 次。<br>因此，总的比较次数为： [ (n-1) + (n-2) + \cdots + 1 &#x3D; \frac{n(n-1)}{2} ]<br>这个和是一个二次函数，时间复杂度为 ( O(n^2) )。</p>
<p>平均情况：<br>在平均情况下，数组元素是随机排列的。<br>冒泡排序仍然需要进行大约 ( \frac{n(n-1)}{2} ) 次比较和交换操作。<br>因此，平均时间复杂度也是 ( O(n^2) )。</p>
<p>最好情况：<br>当数组已经有序时，冒泡排序只需要进行一次完整的遍历来确认没有需要交换的元素。<br>这种情况下，内层循环只执行一次，总的比较次数为 ( n-1 )。<br>因此，最好时间复杂度为 ( O(n) )。<br>空间复杂度<br>冒泡排序是一种原地排序算法，它不需要额外的存储空间来存储数组元素，因此空间复杂度为 ( O(1) )。</p>
<p><img src="/../images/sf.gif"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">var arr2 = [10, 9, 20, 30, 15, 25, 35, 40, 45, 50];</span><br><span class="line">let num = 0;</span><br><span class="line">// 冒泡排序</span><br><span class="line">function bubbleSort(arr) &#123;</span><br><span class="line">    for (let i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">        for (let j = 0; j &lt; arr.length - i - 1; j++) &#123;</span><br><span class="line">            num++;</span><br><span class="line">            if (arr[j] &gt; arr[j + 1]) &#123;</span><br><span class="line">                let temp = arr[j];</span><br><span class="line">                arr[j] = arr[j + 1];</span><br><span class="line">                arr[j + 1] = temp;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bubbleSort(arr2)</span><br><span class="line">console.log(arr2, num); // 输出排序后的次数 45 次，数组排序 如何变都是 45 次 O(n^2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var arr = [9, 10, 15, 20, 25, 30, 35, 40, 45, 50]</span><br><span class="line">num = 0;</span><br><span class="line">// 优化后的冒泡排序</span><br><span class="line">function bubbleSort2(arr) &#123;</span><br><span class="line">    let n = arr.length;</span><br><span class="line">    let swapped;</span><br><span class="line">    do &#123;</span><br><span class="line">        swapped = false;</span><br><span class="line">        for (let i = 0; i &lt; n - 1; i++) &#123;</span><br><span class="line">            if (arr[i] &gt; arr[i + 1]) &#123;</span><br><span class="line">                // 交换 arr[i] 和 arr[i + 1]</span><br><span class="line">                let temp = arr[i];</span><br><span class="line">                arr[i] = arr[i + 1];</span><br><span class="line">                arr[i + 1] = temp;</span><br><span class="line">                swapped = true;</span><br><span class="line">            &#125;</span><br><span class="line">            num++</span><br><span class="line">        &#125;</span><br><span class="line">        // 每次遍历后，最大的元素会被放到最后，所以可以减少一次遍历</span><br><span class="line">        n--;</span><br><span class="line">    &#125; while (swapped);</span><br><span class="line">    return arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let sortedArray = bubbleSort2(arr);</span><br><span class="line">console.log(&quot;Sorted Array:&quot;, sortedArray);</span><br><span class="line">console.log(num); // 输出排序后的次数 9 次, O(n)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/24/nodejs%E5%AE%8F%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%BE%AE%E4%BB%BB%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/24/nodejs%E5%AE%8F%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%BE%AE%E4%BB%BB%E5%8A%A1/" class="post-title-link" itemprop="url">nodejs宏任务和微任务</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-24 14:32:22" itemprop="dateCreated datePublished" datetime="2024-12-24T14:32:22+08:00">2024-12-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index"><span itemprop="name">nodejs</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="nodejs宏任务和微任务"><a href="#nodejs宏任务和微任务" class="headerlink" title="nodejs宏任务和微任务"></a>nodejs宏任务和微任务</h2><p>在 Node.js 中，事件循环机制处理任务的方式分为宏任务（macrotask）和微任务（microtask）。以下是它们的区别及执行顺序：</p>
<ul>
<li><p><strong>宏任务（Macrotask）</strong></p>
<ul>
<li>包含：<code>setTimeout</code>, <code>setInterval</code>, I&#x2F;O 操作, UI 渲染, <code>setImmediate</code></li>
<li>每次执行完一个宏任务后会进入微任务队列检查并执行所有微任务</li>
<li>下一次事件循环开始时才会继续执行下一个宏任务</li>
</ul>
</li>
<li><p><strong>微任务（Microtask）</strong></p>
<ul>
<li>包含：<code>Promise.then</code>, <code>process.nextTick</code>, <code>Object.observe</code>(已废弃), <code>MutationObserver</code></li>
<li>在当前任务（无论是宏任务还是微任务）执行完毕后立即执行，直到微任务队列为空</li>
<li><code>process.nextTick</code> 的优先级最高，在当前操作完成后立即执行，甚至早于其他微任务</li>
</ul>
</li>
</ul>
<h3 id="执行顺序示例："><a href="#执行顺序示例：" class="headerlink" title="执行顺序示例："></a>执行顺序示例：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;start&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 宏任务</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;setTimeout&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 微任务</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 微任务</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">process.<span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 微任务，优先级最高</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;nextTick&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;end&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">start</span><br><span class="line">end</span><br><span class="line">nextTick</span><br><span class="line">promise1</span><br><span class="line">promise2</span><br><span class="line">setTimeout</span><br></pre></td></tr></table></figure>

<p>这是因为：</p>
<ol>
<li>同步代码先执行，输出 <code>start</code> 和 <code>end</code></li>
<li>然后执行微任务队列中的任务，由于 <code>process.nextTick</code> 优先级最高，所以首先输出 <code>nextTick</code></li>
<li>接着执行剩余的微任务，输出 <code>promise1</code> 和 <code>promise2</code></li>
<li>最后回到事件循环执行宏任务，输出 <code>setTimeout</code></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/24/AST%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/24/AST%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">AST学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-24 11:40:26" itemprop="dateCreated datePublished" datetime="2024-12-24T11:40:26+08:00">2024-12-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AST/" itemprop="url" rel="index"><span itemprop="name">AST</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="AST"><a href="#AST" class="headerlink" title="AST"></a>AST</h2><p>在计算机科学中，抽象语法树（Abstract Syntax Tree，AST），是源代码语法结构的⼀种抽象表示。<br>它以树状的形式表现编程语⾔的语法结构，树上的每个节点都表示源代码中的⼀种结构。<br>AST 运⽤⼴泛，⽐如：<br>⾼级语⾔的编译、机器码的⽣成<br>⼀些⾼级编辑器的错误提示、代码⾼亮、代码⾃动补全；<br>对于前端来说很多⼯具，例如 elint 、 pretiier 对代码错误或⻛格的检查，babel、typescript<br>对代码的编译处理等等。<br>AST 转化流程<br>我们可以实现⼀个⾮常简单的词法分析⼯具，来感受⼀下词法分析的魅⼒，以及这中间我们需要处理的<br>内容。<br>在例⼦中我们可以发现，我们通过读取字符串中每个元素，依次记录⾥⾯出现的内容，最终基于内容⽣<br>成配置，然后再基于配置创建新的代码的结构。<br>整个解析过程主要分为以下两个步骤：<br>分词：将整个代码字符串分割成最⼩语法单元数组<br>语法分析：在分词基础上建⽴分析语法单元之间的关系<br>词法分析器⾥，每个关键字是⼀个 Token ，每个标识符是⼀个 Token，每个操作符是⼀个 Token，每<br>个标点符号也都是⼀个 Token。除此之外，还会过滤掉源程序中的注释和空⽩字符（换⾏符、空格、制<br>表符等。<br>我们可以通过 ast-explore 来查看代码⽚段转化的结果：<br>我们可以看到，对于左侧的代码结构，通过解析字符及对应的格式，然后序列化成为⼀个对象的格式，<br>我们可以通过这个对象，来描述整体的代码的内容。<br>如果我们希望将 let 转化为 var，那后续我们只需要在基于配置渲染⽬标时，将 let 转化为 var ⽣成即<br>可。对于 AST 的类型来说，解析的过程中有这么多的类型，针对不同的语句，最终会以下⾯的类型进⾏转<br>化：</p>
<h2 id="模拟-AST-过程"><a href="#模拟-AST-过程" class="headerlink" title="模拟 AST 过程"></a>模拟 AST 过程</h2><p>index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// before: (add 20 (subtract 4 2))</span><br><span class="line">// after: add(2, subtract(4, 2))</span><br><span class="line"></span><br><span class="line">// 分词，处理每个字符内容</span><br><span class="line">function generateToken(str) &#123;</span><br><span class="line">  let current = 0;</span><br><span class="line">  let tokens = [];</span><br><span class="line">  while(current &lt; str.length) &#123;</span><br><span class="line">    let char = str[current];</span><br><span class="line"></span><br><span class="line">    if (char === &quot;(&quot;) &#123;</span><br><span class="line">      tokens.push(&#123;</span><br><span class="line">        type: &quot;paren&quot;,</span><br><span class="line">        value: &quot;(&quot;</span><br><span class="line">      &#125;);</span><br><span class="line">      current++;</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (char === &quot;)&quot;) &#123;</span><br><span class="line">      tokens.push(&#123;</span><br><span class="line">        type: &quot;paren&quot;,</span><br><span class="line">        value: &quot;)&quot;</span><br><span class="line">      &#125;);</span><br><span class="line">      current++;</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (/\s/.test(char)) &#123;</span><br><span class="line">      current++;</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (/[0-9]/.test(char)) &#123;</span><br><span class="line">      let numberValue = &#x27;&#x27;;</span><br><span class="line">      while(/[0-9]/.test(char)) &#123;</span><br><span class="line">        numberValue += char;</span><br><span class="line">        char = str[++current];</span><br><span class="line">      &#125;</span><br><span class="line">      tokens.push(&#123;</span><br><span class="line">        type: &#x27;number&#x27;,</span><br><span class="line">        value: numberValue</span><br><span class="line">      &#125;);</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (/[a-z]/.test(char)) &#123;</span><br><span class="line">      let stringValue = &#x27;&#x27;;</span><br><span class="line">      while(/[a-z]/.test(char)) &#123;</span><br><span class="line">        stringValue += char;</span><br><span class="line">        char = str[++current];</span><br><span class="line">      &#125;</span><br><span class="line">      tokens.push(&#123;</span><br><span class="line">        type: &#x27;name&#x27;,</span><br><span class="line">        value: stringValue</span><br><span class="line">      &#125;);</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    throw new TypeError(&quot;未能识别的字符&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return tokens;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// AST 生成</span><br><span class="line">function generateAST(tokens) &#123;</span><br><span class="line">  let current = 0;</span><br><span class="line"></span><br><span class="line">  let ast = &#123;</span><br><span class="line">    type: &quot;Program&quot;,</span><br><span class="line">    body: [],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  function walk() &#123;</span><br><span class="line">    let token = tokens[current];</span><br><span class="line">    if (token.type === &#x27;number&#x27;) &#123;</span><br><span class="line">      current++;</span><br><span class="line">      return &#123;</span><br><span class="line">        type: &quot;NumberLiteral&quot;,</span><br><span class="line">        value: token.value,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (token.type === &#x27;paren&#x27; &amp;&amp; token.value === &quot;(&quot;) &#123;</span><br><span class="line">      token = tokens[++current];</span><br><span class="line">      let node = &#123;</span><br><span class="line">        type: &quot;CallExpression&quot;,</span><br><span class="line">        name: token.value,</span><br><span class="line">        params: [],</span><br><span class="line">      &#125;;</span><br><span class="line">      token = tokens[++current];</span><br><span class="line"></span><br><span class="line">      while(</span><br><span class="line">        (token.type !== &quot;paren&quot;) || (token.type === &#x27;paren&#x27; &amp;&amp; token.value !== &quot;)&quot;)</span><br><span class="line">      ) &#123;</span><br><span class="line">        node.params.push(walk());</span><br><span class="line">        token = tokens[current];</span><br><span class="line">      &#125;</span><br><span class="line">      current++;</span><br><span class="line">      return node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    throw new TypeError(token.type);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  while(current &lt; tokens.length) &#123;</span><br><span class="line">    ast.body.push(walk())</span><br><span class="line">  &#125;</span><br><span class="line">  return ast;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// AST 转化： babel 插件需要我们处理的部分</span><br><span class="line">function transformer(ast) &#123;</span><br><span class="line">  let newAst = &#123;</span><br><span class="line">    type: &quot;Program&quot;,</span><br><span class="line">    body: [],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  ast._context = newAst.body;</span><br><span class="line"></span><br><span class="line">  DFS(ast, &#123;</span><br><span class="line">    NumberLiteral: &#123;</span><br><span class="line">      enter(node, parent) &#123;</span><br><span class="line">        parent._context.push(&#123;</span><br><span class="line">          type: &quot;NumberLiteral&quot;,</span><br><span class="line">          value: node.value</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    CallExpression: &#123;</span><br><span class="line">      enter(node, parent) &#123;</span><br><span class="line">        let expression = &#123;</span><br><span class="line">          type: &quot;CallExpression&quot;,</span><br><span class="line">          callee: &#123;</span><br><span class="line">            type: &quot;Identifier&quot;,</span><br><span class="line">            name: node.name</span><br><span class="line">          &#125;,</span><br><span class="line">          arguments: [],</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        node._context = expression.arguments;</span><br><span class="line">        if (parent.type !== &quot;CallExpression&quot;) &#123;</span><br><span class="line">          expression = &#123;</span><br><span class="line">            type: &quot;ExpressionStatement&quot;,</span><br><span class="line">            expression: expression,</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        parent._context.push(expression);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  return newAst;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// AST 遍历</span><br><span class="line">function DFS(ast, visitor) &#123;</span><br><span class="line"></span><br><span class="line">  function traverseArray(children, parent) &#123;</span><br><span class="line">    children.forEach(child =&gt; traverseNode(child, parent));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function traverseNode(node, parent) &#123;</span><br><span class="line">    let methods = visitor[node.type];</span><br><span class="line">    if (methods &amp;&amp; methods.enter) &#123;</span><br><span class="line">      methods.enter(node, parent);</span><br><span class="line">    &#125;</span><br><span class="line">    switch(node.type) &#123;</span><br><span class="line">      case &quot;Program&quot;:</span><br><span class="line">        traverseArray(node.body, node);</span><br><span class="line">        break;</span><br><span class="line">      case &quot;CallExpression&quot;:</span><br><span class="line">        traverseArray(node.params, node);</span><br><span class="line">        break;</span><br><span class="line">      case &quot;NumberLiteral&quot;:</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    if (methods &amp;&amp; methods.exit) &#123;</span><br><span class="line">      methods.exit(node, parent);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return traverseNode(ast, null);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ast -&gt; code 生成代码过程</span><br><span class="line">function generate(ast) &#123;</span><br><span class="line">  switch(ast.type) &#123;</span><br><span class="line">    case &quot;Program&quot;: return ast.body.map(subAst =&gt; generate(subAst)).join(&#x27;\n&#x27;);</span><br><span class="line">    case &quot;ExpressionStatement&quot;: return generate(ast.expression) + &quot;;&quot;;</span><br><span class="line">    case &quot;CallExpression&quot;: return generate(ast.callee) + &quot;(&quot; +ast.arguments.map(arg =&gt; generate(arg)).join(&#x27;, &#x27;) + &quot;)&quot;;</span><br><span class="line">    case &quot;Identifier&quot;: return ast.name;</span><br><span class="line">    case &quot;NumberLiteral&quot;: return ast.value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function parser(input) &#123;</span><br><span class="line">  const tokens = generateToken(input);</span><br><span class="line">  console.log(tokens);</span><br><span class="line">  const ast = generateAST(tokens);</span><br><span class="line">  console.log(JSON.stringify(ast, null, 2));</span><br><span class="line">  const newAst = transformer(ast);</span><br><span class="line">  console.log(JSON.stringify(newAst, null, 2));</span><br><span class="line">  const code = generate(newAst);</span><br><span class="line">  return code;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = parser;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>test.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const parser = require(&#x27;./index.js&#x27;);</span><br><span class="line"></span><br><span class="line">const input = &quot;(add 2 (subtract 4 2))&quot;</span><br><span class="line">const output = &quot;add(2,subtract(4,2));&quot;</span><br><span class="line"></span><br><span class="line">console.log(&quot;input&quot;, input);</span><br><span class="line">console.log(&quot;output&quot;, parser(input));</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ThisExpression | Identifier | Literal |</span><br><span class="line">ArrayExpression | ObjectExpression | FunctionExpression |</span><br><span class="line">ArrowFunctionExpression | ClassExpression |</span><br><span class="line">TaggedTemplateExpression | MemberExpression | Super | MetaProperty |</span><br><span class="line">NewExpression | CallExpression | UpdateExpression | AwaitExpression |</span><br><span class="line">UnaryExpression |</span><br><span class="line">BinaryExpression | LogicalExpression | ConditionalExpression |</span><br><span class="line">YieldExpression | AssignmentExpression | SequenceExpression;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>针对不同的⼯具，最终也有不同的效果：<br>@babel&#x2F;parser : 转化为 AST 抽象语法树；<br>@babel&#x2F;traverse 对 AST 节点进⾏递归遍历；<br>@babel&#x2F;types 对具体的 AST 节点进⾏进⾏修改；<br>@babel&#x2F;generator : AST 抽象语法树⽣成为新的代码；</p>
<p>Babel 的处理步骤</p>
<p>Babel 的三个主要处理步骤分别是： 解析（parse），转换（transform），⽣成（generate）。.</p>
<p>词法分析阶段把字符串形式的代码转换为 令牌（tokens） 流。.</p>
<p>你可以把令牌看作是⼀个扁平的语法⽚段数组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n * n;</span><br><span class="line">[</span><br><span class="line">&#123; type: &#123; ... &#125;, value: &quot;n&quot;, start: 0, end: 1, loc: &#123; ... &#125; &#125;,</span><br><span class="line">&#123; type: &#123; ... &#125;, value: &quot;*&quot;, start: 2, end: 3, loc: &#123; ... &#125; &#125;,</span><br><span class="line">&#123; type: &#123; ... &#125;, value: &quot;n&quot;, start: 4, end: 5, loc: &#123; ... &#125; &#125;,</span><br><span class="line">...</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>每⼀个 type 有⼀组属性来描述该令牌：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    type: &#123;</span><br><span class="line">        label: &#x27;name&#x27;,</span><br><span class="line">        keyword: undefined,</span><br><span class="line">        beforeExpr: false,</span><br><span class="line">        startsExpr: true,</span><br><span class="line">        rightAssociative: false,</span><br><span class="line">        isLoop: false,isAssign: false,</span><br><span class="line">        prefix: false,</span><br><span class="line">        postfix: false,</span><br><span class="line">        binop: null,</span><br><span class="line">        updateContext: null</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>和 AST 节点⼀样它们也有 start ， end ， loc 属性。</p>
<p>对于⼀个 babel 插件来说，我们先从先从⼀个接收了当前 babel 对象作为参数的 function 开始。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export default function(babel) &#123;</span><br><span class="line">// plugin contents</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>由于你将会经常这样使⽤，所以直接取出 babel.types 会更⽅便：（译注：这是 ES2015 语法中的对<br>象解构，即 Destructuring）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export default function(&#123; types: t &#125;) &#123;</span><br><span class="line">// plugin contents</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接着返回⼀个对象，其 visitor 属性是这个插件的主要访问者。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">export default function(&#123; types: t &#125;) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        visitor: &#123;</span><br><span class="line">        // visitor contents</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Visitor 中的每个函数接收2个参数： path 和 state</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">export default function(&#123; types: t &#125;) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        visitor: &#123;</span><br><span class="line">            Identifier(path, state) &#123;&#125;,</span><br><span class="line">            ASTNodeTypeHere(path, state) &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>让我们快速编写⼀个可⽤的插件来展示⼀下它是如何⼯作的。下⾯是我们的源代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo === bar;</span><br></pre></td></tr></table></figure>

<p>其 AST 形式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    type: &quot;BinaryExpression&quot;,</span><br><span class="line">    operator: &quot;===&quot;,</span><br><span class="line">    left: &#123;</span><br><span class="line">        type: &quot;Identifier&quot;,</span><br><span class="line">        name: &quot;foo&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    right: &#123;</span><br><span class="line">        type: &quot;Identifier&quot;,</span><br><span class="line">        name: &quot;bar&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>我们从添加 BinaryExpression 访问者⽅法开始：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">export default function(&#123; types: t &#125;) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        visitor: &#123;</span><br><span class="line">            BinaryExpression(path) &#123;</span><br><span class="line">                // ...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们更确切⼀些，只关注哪些使⽤了 &#x3D;&#x3D;&#x3D; 的 BinaryExpression 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">visitor: &#123;</span><br><span class="line">    BinaryExpression(path) &#123;</span><br><span class="line">    if (path.node.operator !== &quot;===&quot;) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>现在我们⽤新的标识符来替换 left 属性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">BinaryExpression(path) &#123;</span><br><span class="line">    if (path.node.operator !== &quot;===&quot;) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    path.node.left = t.identifier(&quot;sebmck&quot;);</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>于是如果我们运⾏这个插件我们会得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sebmck === bar;</span><br></pre></td></tr></table></figure>

<p>现在只需要替换 right 属性了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BinaryExpression(path) &#123;</span><br><span class="line">    if (path.node.operator !== &quot;===&quot;) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    path.node.left = t.identifier(&quot;sebmck&quot;);</span><br><span class="line">    path.node.right = t.identifier(&quot;dork&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这就是我们的最终结果了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sebmck === dork;</span><br></pre></td></tr></table></figure>



<p>我们可以⽤更复杂的⼀些配置来完善我们的插件。。</p>
<h2 id="Babel-插件开发"><a href="#Babel-插件开发" class="headerlink" title="Babel 插件开发"></a>Babel 插件开发</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.</span><br><span class="line">├── index.js</span><br><span class="line">├── node_modules</span><br><span class="line">├── output.js</span><br><span class="line">├── package.json</span><br><span class="line">├── plugin.js</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;babel&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;index.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;keywords&quot;: [],</span><br><span class="line">  &quot;author&quot;: &quot;&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;@babel/core&quot;: &quot;^7.11.1&quot;,</span><br><span class="line">    &quot;@babel/types&quot;: &quot;^7.11.0&quot;,</span><br><span class="line">    &quot;babel-cli&quot;: &quot;^6.26.0&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.babelrc </span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;plugins&quot;: [</span><br><span class="line">    [&quot;./plugin&quot;, &#123;</span><br><span class="line">      &quot;tips&quot;: &quot;newTips&quot;</span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plugin.js</span><br><span class="line"></span><br><span class="line">module.exports = function(&#123;types: t&#125;) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    visitor: &#123;</span><br><span class="line">      Identifier(path, state) &#123;</span><br><span class="line">        const name = path.node.name;</span><br><span class="line">        console.log(state.opts);</span><br><span class="line"></span><br><span class="line">        // path.node.name = `__$&#123;name&#125;`;</span><br><span class="line">        if (state.opts[name]) &#123;</span><br><span class="line">          path.node.name = state.opts[name];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      MemberExpression(path) &#123;</span><br><span class="line">        if (path.get(&quot;object&quot;).matchesPattern(&quot;process.env&quot;)) &#123;</span><br><span class="line">          const key = path.toComputedKey();</span><br><span class="line">          if (t.isStringLiteral(key)) &#123;</span><br><span class="line">            path.replaceWith(t.valueToNode(process.env[key.value]));</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      BinaryExpression(path) &#123;</span><br><span class="line">        console.log(path.node.left);</span><br><span class="line">        console.log(path.node.right);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">index.js</span><br><span class="line"></span><br><span class="line">let tips;</span><br><span class="line">let array;</span><br><span class="line">const a = process.env.NODE_ENV</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">执行babel 编译命令</span><br><span class="line">NODE_ENV=&quot;production&quot; ./node_modules/.bin/babel index.js -o output.js</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">生成 output.js 文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let newTips;</span><br><span class="line">let array;</span><br><span class="line">const a = &quot;production&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>









<p>其他：<br><a target="_blank" rel="noopener" href="https://www.astexplorer.net/">https://www.astexplorer.net/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/23/typescript%E5%A4%8D%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/23/typescript%E5%A4%8D%E4%B9%A0/" class="post-title-link" itemprop="url">typescript复习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-23 17:34:43" itemprop="dateCreated datePublished" datetime="2024-12-23T17:34:43+08:00">2024-12-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/typescript/" itemprop="url" rel="index"><span itemprop="name">typescript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cnpm i typescript</span><br><span class="line">cnpm i @types/node</span><br><span class="line"></span><br><span class="line">npx tsc --init</span><br><span class="line"></span><br><span class="line">生成  tsconfig.json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">npx tsc </span><br><span class="line">npx tsc --watch </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">nodejs 环境的tsconfig.json 配置</span><br><span class="line">&#123;</span><br><span class="line">  &quot;compilerOptions&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">    &quot;target&quot;: &quot;es2016&quot;, //目标代码</span><br><span class="line">    &quot;lib&quot;: [&quot;es2016&quot;], //开发时的库</span><br><span class="line">    // &quot;module&quot;:&quot;ES2015&quot;, //模块规范</span><br><span class="line">    &quot;module&quot;:&quot;CommonJS&quot;, //设置编译结果中使用的模块化标准</span><br><span class="line">    &quot;outDir&quot;: &quot;dist&quot;, //输出目录</span><br><span class="line">    &quot;strictNullChecks&quot;: true, //严格空检查</span><br><span class="line">    &quot;removeComments&quot;: true, //编译结果移除注释</span><br><span class="line">    &quot;esModuleInterop&quot;: true, //兼启用es模块化交互非es模块导出</span><br><span class="line">    &quot;noEmitOnError&quot;: true, // 编译错误不输出编译结果</span><br><span class="line">    // &quot;moduleResolution&quot;: &quot;node&quot; //设置解析模块的模式</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;include&quot;: [&quot;src/**/*&quot;],  //指定编译文件</span><br><span class="line">  // &quot;files&quot;: [&quot;src/index.ts&quot;] //指定编译文件,</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// 泛型 在函数中使用</span><br><span class="line"></span><br><span class="line">function take2&lt;T = number&gt;(arr: T[], n: number): T[]</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    if (n &gt; arr.length) &#123;</span><br><span class="line">        return arr;</span><br><span class="line">    &#125;</span><br><span class="line">    const newArr:T[] = [];</span><br><span class="line"></span><br><span class="line">    for (let i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        newArr.push(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return newArr;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">take2&lt;number&gt;([1,2], 3);</span><br><span class="line"></span><br><span class="line">take2&lt;string&gt;([&#x27;1&#x27;,&#x27;2&#x27;], 3);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>函数的泛型应用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function combin&lt;T extends number | string&gt;(a: T, b: T): T&#123;</span><br><span class="line">    return (a as any) + (b as any) as T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const res = combin(1,2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const res1 = combin(&#x27;a&#x27;,&#x27;b&#x27;);</span><br><span class="line"></span><br><span class="line">// const res2 = combin(3,&#x27;b&#x27;); // 报错</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">函数中的泛型应用</span><br><span class="line"></span><br><span class="line">type callBack&lt;T&gt; = (n: T, i: number) =&gt; boolean;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function filter&lt;T&gt;(arr: T[], callback: callBack&lt;T&gt;): T[]</span><br><span class="line">&#123;</span><br><span class="line">    const newArr: T[] = [];</span><br><span class="line">    for (let i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">        if (callback(arr[i], i)) &#123;</span><br><span class="line">            newArr.push(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return newArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const arr = [1, 2, 3, 4, 5];</span><br><span class="line"></span><br><span class="line">console.log(filter(arr, (n) =&gt; n &gt; 2));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">构造函数中的泛型应用</span><br><span class="line"></span><br><span class="line">class ArrayHelper&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    constructor(private arr: T[])</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    take(n: number): T[]</span><br><span class="line">    &#123;</span><br><span class="line">        if (n &gt; this.arr.length) &#123;</span><br><span class="line">            return this.arr;</span><br><span class="line">        &#125;</span><br><span class="line">        const newArr:T[] = [];</span><br><span class="line">        for (let i = 0; i &lt; n; i++) &#123;</span><br><span class="line">            newArr.push(this.arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        return newArr;</span><br><span class="line">    &#125;</span><br><span class="line">    filter(callback: callBack&lt;T&gt;): T[]</span><br><span class="line">    &#123;</span><br><span class="line">        const newArr: T[] = [];</span><br><span class="line">        for (let i = 0; i &lt; this.arr.length; i++) &#123;</span><br><span class="line">            if (callback(this.arr[i], i)) &#123;</span><br><span class="line">                newArr.push(this.arr[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return newArr;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   shuffle() &#123;</span><br><span class="line"></span><br><span class="line">    for (let i = this.arr.length - 1; i &gt; 0; i--) &#123;</span><br><span class="line">        const j = Math.floor(Math.random() * (i + 1));</span><br><span class="line">        [this.arr[i], this.arr[j]] = [this.arr[j], this.arr[i]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const helper = new ArrayHelper(arr);</span><br><span class="line"></span><br><span class="line">const newA = helper.filter(n =&gt; n &gt; 2);</span><br><span class="line"></span><br><span class="line">console.log(newA);</span><br><span class="line"></span><br><span class="line">helper.shuffle();</span><br><span class="line"></span><br><span class="line">console.log(helper.take(3));</span><br></pre></td></tr></table></figure>

<p>泛型约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">interface hasNameProperty &#123;</span><br><span class="line">    name: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function nameToUpperCase &lt;T extends hasNameProperty&gt; (obj: T): T</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    obj.name = obj.name.split(&quot; &quot;)</span><br><span class="line">        .map(n =&gt; n[0].toUpperCase() + n.slice(1))</span><br><span class="line">        .join(&quot; &quot;);</span><br><span class="line"></span><br><span class="line">    return obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const o = &#123;</span><br><span class="line">    name: &quot;john wang&quot;,</span><br><span class="line">    age: 30</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const newO = nameToUpperCase(o);</span><br><span class="line"></span><br><span class="line">console.log(newO.name);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="导入三方模块"><a href="#导入三方模块" class="headerlink" title="导入三方模块"></a>导入三方模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 导入文件系统模块 在 ts 中异常</span><br><span class="line">// import fs from &#x27;fs&#x27;;</span><br><span class="line"></span><br><span class="line">//需要改写为 </span><br><span class="line">import &#123;readFileSync&#125; from &#x27;fs&#x27;;</span><br><span class="line"></span><br><span class="line">//或改写为</span><br><span class="line">//import * as fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const input = readFileSync(&#x27;./input.txt&#x27;, &#x27;utf-8&#x27;).split(&#x27;\n&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">编译后代码</span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line">Object.defineProperty(exports, &quot;__esModule&quot;, &#123; value: true &#125;);</span><br><span class="line">const fs_1 = require(&quot;fs&quot;);</span><br><span class="line">const input = (0, fs_1.readFileSync)(&#x27;./input.txt&#x27;, &#x27;utf-8&#x27;).split(&#x27;\n&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//或改写为</span><br><span class="line">import * as fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const input = fs.readFileSync(&#x27;./input.txt&#x27;, &#x27;utf-8&#x27;).split(&#x27;\n&#x27;);</span><br><span class="line"></span><br><span class="line">编译后代码</span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line">var __createBinding = (this &amp;&amp; this.__createBinding) || (Object.create ? (function(o, m, k, k2) &#123;</span><br><span class="line">    if (k2 === undefined) k2 = k;</span><br><span class="line">    var desc = Object.getOwnPropertyDescriptor(m, k);</span><br><span class="line">    if (!desc || (&quot;get&quot; in desc ? !m.__esModule : desc.writable || desc.configurable)) &#123;</span><br><span class="line">      desc = &#123; enumerable: true, get: function() &#123; return m[k]; &#125; &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Object.defineProperty(o, k2, desc);</span><br><span class="line">&#125;) : (function(o, m, k, k2) &#123;</span><br><span class="line">    if (k2 === undefined) k2 = k;</span><br><span class="line">    o[k2] = m[k];</span><br><span class="line">&#125;));</span><br><span class="line">var __setModuleDefault = (this &amp;&amp; this.__setModuleDefault) || (Object.create ? (function(o, v) &#123;</span><br><span class="line">    Object.defineProperty(o, &quot;default&quot;, &#123; enumerable: true, value: v &#125;);</span><br><span class="line">&#125;) : function(o, v) &#123;</span><br><span class="line">    o[&quot;default&quot;] = v;</span><br><span class="line">&#125;);</span><br><span class="line">var __importStar = (this &amp;&amp; this.__importStar) || (function () &#123;</span><br><span class="line">    var ownKeys = function(o) &#123;</span><br><span class="line">        ownKeys = Object.getOwnPropertyNames || function (o) &#123;</span><br><span class="line">            var ar = [];</span><br><span class="line">            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;</span><br><span class="line">            return ar;</span><br><span class="line">        &#125;;</span><br><span class="line">        return ownKeys(o);</span><br><span class="line">    &#125;;</span><br><span class="line">    return function (mod) &#123;</span><br><span class="line">        if (mod &amp;&amp; mod.__esModule) return mod;</span><br><span class="line">        var result = &#123;&#125;;</span><br><span class="line">        if (mod != null) for (var k = ownKeys(mod), i = 0; i &lt; k.length; i++) if (k[i] !== &quot;default&quot;) __createBinding(result, mod, k[i]);</span><br><span class="line">        __setModuleDefault(result, mod);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line">Object.defineProperty(exports, &quot;__esModule&quot;, &#123; value: true &#125;);</span><br><span class="line">const fs = __importStar(require(&quot;fs&quot;));</span><br><span class="line">const input = fs.readFileSync(&#x27;./input.txt&#x27;, &#x27;utf-8&#x27;).split(&#x27;\n&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>非要用 import fs from ‘fs’; 要改写 配置文件</p>
<p>增加<br>“esModuleInterop”: true, &#x2F;&#x2F;兼容es6模块</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import fs from &#x27;fs&#x27;;</span><br><span class="line">const input = fs.readFileSync(&#x27;./input.txt&#x27;, &#x27;utf-8&#x27;).split(&#x27;\n&#x27;);</span><br><span class="line"></span><br><span class="line">编译后代码</span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line">var __importDefault = (this &amp;&amp; this.__importDefault) || function (mod) &#123;</span><br><span class="line">    return (mod &amp;&amp; mod.__esModule) ? mod : &#123; &quot;default&quot;: mod &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">Object.defineProperty(exports, &quot;__esModule&quot;, &#123; value: true &#125;);</span><br><span class="line">const fs_1 = __importDefault(require(&quot;fs&quot;));</span><br><span class="line">const input = fs_1.default.readFileSync(&#x27;./input.txt&#x27;, &#x27;utf-8&#x27;).split(&#x27;\n&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="TS中书写-commjs-模块代码"><a href="#TS中书写-commjs-模块代码" class="headerlink" title="TS中书写 commjs 模块代码"></a>TS中书写 commjs 模块代码</h2><p>导出 export &#x3D; xxxx</p>
<p>导入 import xxx &#x3D; require(‘xxx’);</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">c.ts</span><br><span class="line">export = &#123;</span><br><span class="line">    add: (a:number,b:number)=&gt;a+b,</span><br><span class="line">    name: &#x27;c&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">05.ts</span><br><span class="line"></span><br><span class="line">import aa = require(&#x27;./c&#x27;);</span><br><span class="line"></span><br><span class="line">console.log(aa.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">编译后代码</span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line">Object.defineProperty(exports, &quot;__esModule&quot;, &#123; value: true &#125;);</span><br><span class="line">const aa = require(&quot;./c&quot;);</span><br><span class="line">console.log(aa.name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;use strict&quot;;</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    add: (a, b) =&gt; a + b,</span><br><span class="line">    name: &#x27;c&#x27;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>




<h2 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">enum Gend &#123;</span><br><span class="line">    Male = &#x27;male&#x27;,</span><br><span class="line">    Female = &#x27;female&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let gen: Gend;</span><br><span class="line"></span><br><span class="line">gen = Gend.Male;</span><br><span class="line">gen = Gend.Female;</span><br><span class="line"></span><br><span class="line">会参与编译 枚举属性的值是字符串或数字，为数字时会自增，可以赋值（不建议）</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="接口和别名"><a href="#接口和别名" class="headerlink" title="接口和别名"></a>接口和别名</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">type Gender = &#x27;male&#x27; | &#x27;female&#x27;;</span><br><span class="line">let gender: Gender;</span><br><span class="line">gender = &#x27;male&#x27;;</span><br><span class="line">gender = &#x27;female&#x27;;</span><br><span class="line"></span><br><span class="line">function showGender(gender: Gender): void</span><br><span class="line">&#123;</span><br><span class="line">    console.log(gender);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">//接口</span><br><span class="line">interface Person &#123;</span><br><span class="line">    name: string;</span><br><span class="line">    age: number;</span><br><span class="line">    sayHello(): void;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 类型别名</span><br><span class="line">type Person2 = &#123;</span><br><span class="line">    name: string;</span><br><span class="line">    age: number;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let p1: Person = &#123;</span><br><span class="line">    name: &#x27;zhangsan&#x27;,</span><br><span class="line">    age: 18,</span><br><span class="line">    sayHello()&#123;</span><br><span class="line">        console.log(&#x27;hello&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let p2: Person2 = &#123;</span><br><span class="line">    name: &#x27;zhangsan&#x27;,</span><br><span class="line">    age: 18</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">type Condition = (n: number) =&gt; boolean;</span><br><span class="line"></span><br><span class="line">function sum(number: number[], callback: Condition) &#123;</span><br><span class="line"></span><br><span class="line">    let s = 0;</span><br><span class="line"></span><br><span class="line">    number.forEach(n =&gt; &#123;</span><br><span class="line">        if (callback(n)) &#123;</span><br><span class="line">            s += n;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const result =  sum([1,2,3,4,5], n =&gt; n % 2 === 0);</span><br><span class="line"></span><br><span class="line">console.log(result);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="接口（Interface）和类型别名（Type-Alias）的区别"><a href="#接口（Interface）和类型别名（Type-Alias）的区别" class="headerlink" title="接口（Interface）和类型别名（Type Alias）的区别"></a>接口（Interface）和类型别名（Type Alias）的区别</h2><p>在 TypeScript 中，接口和类型别名都可以用来定义对象的形状，但它们有一些关键的区别。以下是它们的主要差异：</p>
<h3 id="1-扩展性（Extensibility）"><a href="#1-扩展性（Extensibility）" class="headerlink" title="1. 扩展性（Extensibility）"></a>1. 扩展性（Extensibility）</h3><ul>
<li><p><strong>接口</strong>：可以使用 <code>extends</code> 关键字来扩展其他接口。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Employee</span> <span class="keyword">extends</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">employeeId</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>类型别名</strong>：不能直接扩展其他类型别名，但可以通过交叉类型（intersection types）实现类似的效果。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Person</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Employee</span> = <span class="title class_">Person</span> &amp; &#123;</span><br><span class="line">    <span class="attr">employeeId</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-合并（Merging）"><a href="#2-合并（Merging）" class="headerlink" title="2. 合并（Merging）"></a>2. 合并（Merging）</h3><ul>
<li><p><strong>接口</strong>：支持声明合并（declaration merging），即多个同名接口会自动合并为一个接口。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>类型别名</strong>：不支持声明合并，多个同名类型别名会导致编译错误。</p>
</li>
</ul>
<h3 id="3-使用场景"><a href="#3-使用场景" class="headerlink" title="3. 使用场景"></a>3. 使用场景</h3><ul>
<li><p><strong>接口</strong>：主要用于定义对象的形状，通常用于描述类、函数参数或返回值等。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Admin</span> <span class="keyword">implements</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">role</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>类型别名</strong>：更加灵活，可以用于定义原始类型、联合类型、元组等复杂类型。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="variable constant_">ID</span> = <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Point</span> = [<span class="built_in">number</span>, <span class="built_in">number</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialPerson</span> = &#123;</span><br><span class="line">    name?: <span class="built_in">string</span>;</span><br><span class="line">    age?: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-可重载（Overloading）"><a href="#4-可重载（Overloading）" class="headerlink" title="4. 可重载（Overloading）"></a>4. 可重载（Overloading）</h3><ul>
<li><p><strong>接口</strong>：可以用于函数重载。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Func</span> &#123;</span><br><span class="line">    (<span class="attr">a</span>: <span class="built_in">number</span>): <span class="built_in">number</span>;</span><br><span class="line">    (<span class="attr">a</span>: <span class="built_in">string</span>): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>类型别名</strong>：不能直接用于函数重载，但可以通过函数类型定义实现类似效果。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Func</span> = &#123;</span><br><span class="line">    (<span class="attr">a</span>: <span class="built_in">number</span>): <span class="built_in">number</span>;</span><br><span class="line">    (<span class="attr">a</span>: <span class="built_in">string</span>): <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-性能"><a href="#5-性能" class="headerlink" title="5. 性能"></a>5. 性能</h3><ul>
<li><strong>接口</strong>：编译后会被优化掉，不会生成额外的 JavaScript 代码。</li>
<li><strong>类型别名</strong>：同样不会生成额外的 JavaScript 代码，但在某些情况下可能会有细微的性能差异。</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>如果你需要定义对象的形状并且希望支持扩展和合并，建议使用接口。</li>
<li>如果你需要定义更复杂的类型（如联合类型、元组等），或者需要更高的灵活性，建议使用类型别名。</li>
</ul>
<p>在你的代码中，<code>Person</code> 和 <code>Person2</code> 分别使用了接口和类型别名来定义相同的内容。你可以根据上述区别选择更适合你需求的方式。</p>
<h2 id="可重载"><a href="#可重载" class="headerlink" title="可重载"></a>可重载</h2><p>在 TypeScript 中，函数重载（Function Overloading） 是指定义多个具有相同名称但参数列表不同的函数签名。编译器会根据调用时传递的参数类型和数量来选择最匹配的函数签名。函数重载允许你为同一个函数提供多种调用方式，从而提高代码的灵活性和可读性。</p>
<p>示例：</p>
<p>typescript</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 定义两个重载签名</span><br><span class="line">function add(a: number, b: number): number;</span><br><span class="line">function add(a: string, b: string): string;</span><br><span class="line"></span><br><span class="line">// 实现函数</span><br><span class="line">function add(a: any, b: any): any &#123;</span><br><span class="line">    return a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 调用</span><br><span class="line">console.log(add(1, 2));      // 输出: 3</span><br><span class="line">console.log(add(&quot;hello&quot;, &quot; world&quot;));  // 输出: hello world</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="访问修饰符"><a href="#访问修饰符" class="headerlink" title="访问修饰符"></a>访问修饰符</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class User &#123;</span><br><span class="line">    </span><br><span class="line">    readonly id:number</span><br><span class="line">    name:string</span><br><span class="line">    age:number</span><br><span class="line">    pid?:string</span><br><span class="line"></span><br><span class="line">    // ts语法 访问修饰符</span><br><span class="line">    private publishNumber:number = 3</span><br><span class="line">    private curNumber:number = 0</span><br><span class="line"></span><br><span class="line">    constructor(name:string,age:number)&#123;</span><br><span class="line">        this.id = Math.random();</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    publish()&#123;</span><br><span class="line">        if (this.curNumber &gt;= this.publishNumber) &#123;</span><br><span class="line">            console.log(`$&#123;this.name&#125; 已经发布文章上限`);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        this.curNumber++;</span><br><span class="line">        console.log(`$&#123;this.name&#125; 发布了第$&#123;this.curNumber&#125;篇文章`);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const u = new User(&#x27;张三&#x27;,18);</span><br><span class="line">u.pid = &#x27;1111&#x27;;</span><br><span class="line">// u.id = 2;</span><br><span class="line">console.log(u.id);</span><br><span class="line">console.log(u.pid);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">u.publish();</span><br><span class="line">u.publish();</span><br><span class="line">u.publish();</span><br><span class="line">u.publish();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">编译后代码</span><br><span class="line">==&gt;&gt;</span><br><span class="line"></span><br><span class="line">class User &#123;</span><br><span class="line">    constructor(name, age) &#123;</span><br><span class="line">        this.publishNumber = 3;</span><br><span class="line">        this.curNumber = 0;</span><br><span class="line">        this.id = Math.random();</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    publish() &#123;</span><br><span class="line">        if (this.curNumber &gt;= this.publishNumber) &#123;</span><br><span class="line">            console.log(`$&#123;this.name&#125; 已经发布文章上限`);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        this.curNumber++;</span><br><span class="line">        console.log(`$&#123;this.name&#125; 发布了第$&#123;this.curNumber&#125;篇文章`);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">const u = new User(&#x27;张三&#x27;, 18);</span><br><span class="line">u.pid = &#x27;1111&#x27;;</span><br><span class="line">console.log(u.id);</span><br><span class="line">console.log(u.pid);</span><br><span class="line">u.publish();</span><br><span class="line">u.publish();</span><br><span class="line">u.publish();</span><br><span class="line">u.publish();</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="React-TS"><a href="#React-TS" class="headerlink" title="React + TS"></a>React + TS</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="JSX-和-TSX-的区别"><a href="#JSX-和-TSX-的区别" class="headerlink" title="JSX 和 TSX 的区别"></a>JSX 和 TSX 的区别</h2><p>在 React 开发中，JSX 和 TSX 是两种不同的文件扩展名，它们用于定义组件的模板语法。以下是它们的主要区别：</p>
<h3 id="1-文件扩展名"><a href="#1-文件扩展名" class="headerlink" title="1. 文件扩展名"></a>1. 文件扩展名</h3><ul>
<li><strong>JSX</strong>: 文件扩展名为 <code>.jsx</code>，主要用于编写 React 组件，但不包含 TypeScript 类型检查。</li>
<li><strong>TSX</strong>: 文件扩展名为 <code>.tsx</code>，不仅支持 JSX 语法，还集成了 TypeScript 的类型检查功能。</li>
</ul>
<h3 id="2-类型检查"><a href="#2-类型检查" class="headerlink" title="2. 类型检查"></a>2. 类型检查</h3><ul>
<li><strong>JSX</strong>: 没有内置的类型检查功能，因此无法在编译时捕获类型错误。</li>
<li><strong>TSX</strong>: 支持 TypeScript 的类型检查，可以在编译时检测并报告类型错误，提高代码的健壮性和可维护性。</li>
</ul>
<h3 id="3-语法兼容性"><a href="#3-语法兼容性" class="headerlink" title="3. 语法兼容性"></a>3. 语法兼容性</h3><ul>
<li><strong>JSX</strong>: 只能使用 JavaScript 语法。</li>
<li><strong>TSX</strong>: 可以使用 TypeScript 语法，包括类型注解、接口、泛型等。</li>
</ul>
<h3 id="4-示例代码"><a href="#4-示例代码" class="headerlink" title="4. 示例代码"></a>4. 示例代码</h3><h3 id="JSX-示例"><a href="#JSX-示例" class="headerlink" title="JSX 示例"></a>JSX 示例</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyComponent.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MyComponent</span>;</span><br></pre></td></tr></table></figure>

<h3 id="TSX-示例"><a href="#TSX-示例" class="headerlink" title="TSX 示例"></a>TSX 示例</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyComponent.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MyComponentProps</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * React.FC&lt;MyComponentProps&gt; 是 TypeScript 中用于定义 React 函数组件的一种类型。</span></span><br><span class="line"><span class="comment">    React.FC 是 React.FunctionComponent 的缩写，它是一个泛型，可以接受一个对象作为参数，这个对象描述了组件的属性类型。</span></span><br><span class="line"><span class="comment">    MyComponentProps 是你自定义的一个接口或类型，用来定义组件接收的 props 类型。</span></span><br><span class="line"><span class="comment">    使用 React.FC&lt;MyComponentProps&gt; 有以下好处：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    明确指定了组件的 props 类型，增强了代码的可读性和可维护性。</span></span><br><span class="line"><span class="comment">    提供了更好的编辑器支持，如自动补全和类型检查。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> ** /</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> // 推荐使用</span></span><br><span class="line"><span class="comment">const MyComponent: React.FC&lt;MyComponentProps&gt; = (&#123; name &#125;) =&gt; &#123;</span></span><br><span class="line"><span class="comment">    return (</span></span><br><span class="line"><span class="comment">        &lt;div&gt;</span></span><br><span class="line"><span class="comment">            &lt;h1&gt;Hello, &#123;name&#125;&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">        &lt;/div&gt;</span></span><br><span class="line"><span class="comment">    );</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">export default MyComponent;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">或者</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">export function MyComponent(props: MyComponentProps) &#123;</span></span><br><span class="line"><span class="comment">    return (</span></span><br><span class="line"><span class="comment">        &lt;div&gt;</span></span><br><span class="line"><span class="comment">            &lt;h1&gt;Hello, &#123;props.name&#125;&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">        &lt;/div&gt;</span></span><br><span class="line"><span class="comment">    )</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>

<h3 id="5-编译和工具支持"><a href="#5-编译和工具支持" class="headerlink" title="5. 编译和工具支持"></a>5. 编译和工具支持</h3><ul>
<li><strong>JSX</strong>: 使用 Babel 等工具进行编译，通常与 Webpack 或其他模块打包工具结合使用。</li>
<li><strong>TSX</strong>: 使用 TypeScript 编译器（tsc）进行编译，同时可以与 Babel 结合使用以支持更广泛的浏览器兼容性。</li>
</ul>
<h3 id="6-性能"><a href="#6-性能" class="headerlink" title="6. 性能"></a>6. 性能</h3><ul>
<li><strong>JSX</strong> 和 <strong>TSX</strong> 在运行时性能上没有显著差异，因为最终都会被编译为普通的 JavaScript 代码。但是，TSX 提供了更好的开发时体验，减少了潜在的类型错误。</li>
</ul>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><ul>
<li>如果你希望在 React 项目中使用 TypeScript 进行类型检查和增强的开发体验，建议使用 <code>.tsx</code> 文件。</li>
<li>如果你只需要简单的 JSX 语法且不需要 TypeScript 的类型检查，可以选择 <code>.jsx</code> 文件。</li>
</ul>
<p>在现代 React 开发中，推荐使用 <code>.tsx</code> 文件，因为它提供了更好的类型安全性和开发体验。</p>
<h2 id="tsx-中-extends-React-Component-使用举例"><a href="#tsx-中-extends-React-Component-使用举例" class="headerlink" title="tsx 中 extends React.Component 使用举例"></a>tsx 中 extends React.Component 使用举例</h2><p>在 TypeScript 中，如果你使用 <code>tsx</code> 文件并希望定义一个继承自 <code>React.Component</code> 的类组件，你可以按照以下步骤进行。假设你已经安装了 <code>react</code> 和 <code>react-dom</code>，并且已经正确配置了 <code>tsconfig.json</code> 以支持 JSX。</p>
<p>以下是一个简单的例子：</p>
<ol>
<li><p>首先，确保你已经安装了 <code>@types/react</code> 和 <code>@types/react-dom</code>，以便 TypeScript 能够识别 React 类型。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @types/react @types/react-dom</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个 <code>.tsx</code> 文件，例如 <code>MyComponent.tsx</code>，并在其中定义一个继承自 <code>React.Component</code> 的类组件。</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MyComponentProps</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MyComponentState</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>&lt;<span class="title class_">MyComponentProps</span>, <span class="title class_">MyComponentState</span>&gt; &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">props</span>: <span class="title class_">MyComponentProps</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  incrementCount = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">prevState</span>) =&gt;</span> (&#123;</span><br><span class="line">      <span class="attr">count</span>: prevState.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>You clicked &#123;this.state.count&#125; times<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.incrementCount&#125;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MyComponent</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>在这个例子中：</p>
<ul>
<li><code>MyComponentProps</code> 定义了组件的 props 类型。</li>
<li><code>MyComponentState</code> 定义了组件的状态类型。</li>
<li><code>MyComponent</code> 类继承自 <code>React.Component</code>，并指定了 props 和 state 的类型。</li>
<li><code>incrementCount</code> 方法用于更新组件的状态。</li>
<li><code>render</code> 方法返回组件的 JSX 结构。</li>
</ul>
<p>确保你的 <code>tsconfig.json</code> 文件配置正确，以便支持 JSX 语法。你可以在 <code>compilerOptions</code> 中添加 <code>&quot;jsx&quot;: &quot;react&quot;</code> 来明确指定 JSX 的处理方式。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es2016&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;es2016&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dom&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CommonJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dist&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strictNullChecks&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;removeComments&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;noEmitOnError&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/**/*&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>这样配置后，TypeScript 就能够正确处理 <code>.tsx</code> 文件中的 JSX 语法。</p>
<h2 id="TS-VUE3"><a href="#TS-VUE3" class="headerlink" title="TS + VUE3"></a>TS + VUE3</h2><p><a target="_blank" rel="noopener" href="https://cn.vuejs.org/guide/typescript/composition-api.html">https://cn.vuejs.org/guide/typescript/composition-api.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/20/%E6%B2%B9%E7%8C%B4%E8%84%9A%E6%9C%AC%E4%B8%AD%E6%93%8D%E4%BD%9Cdom%E6%8E%A7%E5%88%B6vue-element-%E4%B8%AD-el-input-%E7%9A%84%E5%80%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wangzhiwei">
      <meta itemprop="description" content="javascript nodejs web developer...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/20/%E6%B2%B9%E7%8C%B4%E8%84%9A%E6%9C%AC%E4%B8%AD%E6%93%8D%E4%BD%9Cdom%E6%8E%A7%E5%88%B6vue-element-%E4%B8%AD-el-input-%E7%9A%84%E5%80%BC/" class="post-title-link" itemprop="url">油猴脚本中操作dom控制vue-element 中 el-input 的值</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-20 09:06:08" itemprop="dateCreated datePublished" datetime="2024-12-20T09:06:08+08:00">2024-12-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-18 11:10:52" itemprop="dateModified" datetime="2025-03-18T11:10:52+08:00">2025-03-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E5%85%B7%E9%9B%86%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">工具集合</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>要使用油猴插件（Tampermonkey）修改Vue-Element的el-input的值，关键在于理解Vue的响应式原理和事件触发机制。以下是具体的步骤和代码示例：</p>
<ol>
<li>获取el-input元素：首先，你需要定位到页面中的el-input元素。可以使用CSS选择器来获取这个元素。</li>
<li>修改值：直接设置input元素的value属性是不够的，因为这样不会触发Vue的响应式更新。你需要手动触发一个input事件来通知Vue更新其数据。</li>
<li>触发事件：创建一个新的Event对象，并使用dispatchEvent方法来触发input事件，这样Vue就能检测到输入框的值变化。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         login</span></span><br><span class="line"><span class="comment">// @namespace    https://192.168.40.51:8000</span></span><br><span class="line"><span class="comment">// @version      2024-12-20</span></span><br><span class="line"><span class="comment">// @description  try to take over the world!</span></span><br><span class="line"><span class="comment">// @author       jason</span></span><br><span class="line"><span class="comment">// @match        https://192.168.40.51:8000/*</span></span><br><span class="line"><span class="comment">// @icon         data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==</span></span><br><span class="line"><span class="comment">// @grant        none</span></span><br><span class="line"><span class="comment">// @run-at       document-idle</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello login&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> userName = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.el-input__inner&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> (userName) &#123;</span><br><span class="line">            userName.<span class="property">value</span> = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">            userName.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123; <span class="attr">bubbles</span>: <span class="literal">true</span>, <span class="attr">cancelable</span>: <span class="literal">true</span> &#125;));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Username input not found&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> passWord = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.el-input__inner&#x27;</span>)[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (passWord) &#123;</span><br><span class="line">            passWord.<span class="property">value</span> = <span class="string">&#x27;xxx&#x27;</span>;</span><br><span class="line">            passWord.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123; <span class="attr">bubbles</span>: <span class="literal">true</span>, <span class="attr">cancelable</span>: <span class="literal">true</span> &#125;));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Password input not found&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.el-button&#x27;</span>).<span class="title function_">click</span>()</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>拦截所有ajax请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">// ==UserScript==</span><br><span class="line">// @name         拦截所有ajax请求</span><br><span class="line">// @namespace    https://192.168.40.51:8000</span><br><span class="line">// @version      2024-12-20</span><br><span class="line">// @description  try to take over the world!</span><br><span class="line">// @author       jason</span><br><span class="line">// @match        http://192.168.40.117:8080/*</span><br><span class="line">// @match        https://192.168.40.51:8000/*</span><br><span class="line">// @match        https://192.168.40.46/*</span><br><span class="line">// @match        http://192.168.40.115:8080/*</span><br><span class="line">// @match        https://192.168.40.116/*</span><br><span class="line">// @match        http://localhost:8000/*</span><br><span class="line">// @match        https://localhost:8000/*</span><br><span class="line">// @icon         data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==</span><br><span class="line">// @grant        none</span><br><span class="line">// @run-at       document-start</span><br><span class="line">// ==/UserScript==</span><br><span class="line"></span><br><span class="line">(function() &#123;</span><br><span class="line">    &#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">    // 保存原始的 XMLHttpRequest 方法</span><br><span class="line">    const originalOpen = XMLHttpRequest.prototype.open;</span><br><span class="line">    const originalSend = XMLHttpRequest.prototype.send;</span><br><span class="line">    const originalSetRequestHeader = XMLHttpRequest.prototype.setRequestHeader;</span><br><span class="line"></span><br><span class="line">    // 重写 open 方法</span><br><span class="line">    XMLHttpRequest.prototype.open = function(method, url, async) &#123;</span><br><span class="line">        this._method = method;</span><br><span class="line">        this._url = url;</span><br><span class="line">        this._async = async;</span><br><span class="line">        this._requestHeaders = &#123;&#125;; // 用于存储请求头</span><br><span class="line">        this._requestData = null; // 用于存储请求体</span><br><span class="line">        originalOpen.apply(this, arguments);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // 重写 setRequestHeader 方法</span><br><span class="line">    XMLHttpRequest.prototype.setRequestHeader = function(header, value) &#123;</span><br><span class="line">        this._requestHeaders[header] = value;</span><br><span class="line">        originalSetRequestHeader.apply(this, arguments);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // 重写 send 方法</span><br><span class="line">    XMLHttpRequest.prototype.send = function(data) &#123;</span><br><span class="line">        // 捕获请求体</span><br><span class="line">        if (data instanceof FormData) &#123;</span><br><span class="line">            const formData = new FormData();</span><br><span class="line">            data.forEach((value, key) =&gt; &#123;</span><br><span class="line">                formData.append(key, value);</span><br><span class="line">            &#125;);</span><br><span class="line">            this._requestData = formData;</span><br><span class="line">        &#125; else if (data instanceof Blob || data instanceof ArrayBuffer) &#123;</span><br><span class="line">            this._requestData = data;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            this._requestData = data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.addEventListener(&#x27;load&#x27;, function() &#123;</span><br><span class="line">            console.log(&#x27;AJAX Request:&#x27;, &#123;</span><br><span class="line">                method: this._method,</span><br><span class="line">                url: this._url,</span><br><span class="line">                async: this._async,</span><br><span class="line">                requestHeaders: this._requestHeaders, // 添加请求头信息</span><br><span class="line">                requestData: this._requestData, // 添加请求体信息</span><br><span class="line">                response: this.responseText,</span><br><span class="line">                status: this.status,</span><br><span class="line">                statusText: this.statusText</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        originalSend.apply(this, arguments);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    console.log(&#x27;hello login&#x27;);</span><br><span class="line">    // 其他代码...</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>在油猴脚本中，@run-at 元数据块用于指定脚本何时执行。不同的 @run-at 值会影响脚本的执行时机，从而影响脚本的行为和效果。以下是常见的 @run-at 值及其含义：</p>
<p>@run-at document-start</p>
<p>含义：脚本在文档解析开始时立即执行，此时 document.documentElement 可能尚未创建，document.head 也尚未完全加载。<br>适用场景：适用于需要在页面加载之前执行某些操作的情况，例如修改页面的初始加载行为。<br>@run-at document-end</p>
<p>含义：脚本在文档解析完成后执行，此时 document.body 已经可用，但所有外部资源（如图片、样式表、子框架等）可能尚未加载完成。<br>适用场景：适用于需要在页面加载完成后执行某些操作的情况，但不需要等待所有外部资源加载完成。<br>@run-at document-idle</p>
<p>含义：脚本在文档解析完成后且所有外部资源（如图片、样式表、子框架等）加载完成后执行。<br>适用场景：适用于需要在页面完全加载后执行某些操作的情况，确保所有资源都已加载完毕。</p>
<p>注意匹配规则设置</p>
<p>&#x2F;&#x2F; @match        <a target="_blank" rel="noopener" href="http://192.168.40.117:8080/">http://192.168.40.117:8080/</a>*<br>&#x2F;&#x2F; @match        <a target="_blank" rel="noopener" href="https://192.168.40.51:8000/">https://192.168.40.51:8000/</a>*<br>&#x2F;&#x2F; @match        <a target="_blank" rel="noopener" href="https://192.168.40.46/">https://192.168.40.46/</a>*<br>&#x2F;&#x2F; @match        <a target="_blank" rel="noopener" href="http://192.168.40.115:8080/">http://192.168.40.115:8080/</a>*</p>
<p>http https 要区分 <a target="_blank" rel="noopener" href="https://192.168.40.46/">https://192.168.40.46/</a>* 改为 <a target="_blank" rel="noopener" href="https://192.168.40.*/">https://192.168.40.*/</a>* 不生效</p>
<p>与其他库（如react）集成： 当你需要与不基于 Vue 的库或框架集成时，可能会用到 dispatchEvent 来触发特定的事件。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">wangzhiwei</p>
  <div class="site-description" itemprop="description">javascript nodejs web developer...</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">65</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">56</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">62</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wangzhiwei</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
